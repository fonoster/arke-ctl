(this["webpackJsonproutr-ui"]=this["webpackJsonproutr-ui"]||[]).push([[0],{148:function(e,t,a){e.exports=a(582)},153:function(e,t,a){},154:function(e,t,a){},582:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(12),o=a.n(s),l=a(7),c=(a(153),a(154),a(155),a(663)),i=a(620),d=a(624),u=a(625),m=a(107),p=a.n(m),h=a(626),g=a(125),S=a(4);class b extends n.a.Component{constructor(...e){super(...e),this.state={auth:!0,anchorEl:null},this.handleChange=(e,t)=>{this.setState({auth:t})},this.handleMenu=e=>{this.setState({anchorEl:e.currentTarget})},this.handleClose=()=>{this.setState({anchorEl:null})}}render(){const e=this.props,t=e.classes,a=e.appStore,r=this.state,s=r.auth,o=r.anchorEl,l=Boolean(o);return n.a.createElement("div",null,n.a.createElement(i.a,{position:"static",color:"primary"},n.a.createElement(d.a,null,n.a.createElement("img",{src:"/images/logo.png",className:"App-logo",alt:"logo"}),n.a.createElement("span",{className:t.flex}),s&&n.a.createElement("div",null,n.a.createElement(u.a,{"aria-owns":l?"menu-appbar":null,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},n.a.createElement(p.a,null)),n.a.createElement(g.a,{id:"menu-appbar",anchorEl:o,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:l,onClose:this.handleClose},n.a.createElement(h.a,{onClick:()=>{a.setCurrentSection("settings"),this.handleClose()}},"Settings"),n.a.createElement(h.a,{onClick:()=>{a.setAboutDialogOpen(),this.handleClose()}},"About"))))))}}var E=Object(l.b)("appStore")(Object(S.a)({root:{flexGrow:1},flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20},githubButton:{bordeR:0,color:"red"}})(Object(l.c)(b))),v=a(629),f=a(585),y=a(627),C=a(628),P=a(108),w=a.n(P),k=a(71),O=a.n(k),x=a(111),T=a.n(x),N=a(109),R=a.n(N),A=a(112),L=a.n(A),j=a(110),D=a.n(j),z=a(113),I=a.n(z),U=a(114),M=a.n(U),B=a(115),F=a.n(B);class K extends n.a.Component{render(){const e=this.props,t=e.classes,a=e.apiStore,r=e.appStore,s=(e,t)=>{r.setCurrentSection(t),r.isResourceSection()||r.isLocOrRegSection()?a.loadResources(t):r.isSettingsSection()&&a.loadConfig()};return n.a.createElement("div",{className:t.root},n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"domains")},n.a.createElement(y.a,null,n.a.createElement(w.a,null)),n.a.createElement(C.a,{primary:"Domains"})),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"agents")},n.a.createElement(y.a,null,n.a.createElement(R.a,null)),n.a.createElement(C.a,{primary:"Agents"})),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"peers")},n.a.createElement(y.a,null,n.a.createElement(D.a,null)),n.a.createElement(C.a,{primary:"Peers"})),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"gateways")},n.a.createElement(y.a,null,n.a.createElement(T.a,null)),n.a.createElement(C.a,{primary:"Gateways"})),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"numbers")},n.a.createElement(y.a,null,n.a.createElement(L.a,null)),n.a.createElement(C.a,{primary:"Numbers"})),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"location")},n.a.createElement(y.a,null,n.a.createElement(I.a,null)),n.a.createElement(C.a,{primary:"Location"})),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"registration")},n.a.createElement(y.a,null,n.a.createElement(M.a,null)),n.a.createElement(C.a,{primary:"Registration"})),n.a.createElement(v.a,null),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"settings")},n.a.createElement(y.a,null,n.a.createElement(O.a,null)),n.a.createElement(C.a,{primary:"Settings"})),n.a.createElement(f.a,{button:!0,onClick:e=>window.open("https://github.com/fonoster/routr/issues","_blank")},n.a.createElement(y.a,null,n.a.createElement(F.a,null)),n.a.createElement(C.a,{primary:"Help"})))}}var _=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)(e=>({root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper}}))(Object(l.c)(K)))),W=a(3),H=a(634),J=a(635),q=a(632),G=a(630),Y=a(661),$=a(631),V=a(662),X=a(39),Z=a(88),Q=a(654),ee=a(633),te=a(117),ae=a.n(te),re=a(118),ne=a.n(re),se=a(73);function oe(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}class le extends n.a.Component{constructor(...e){super(...e),this.createSortHandler=e=>t=>{this.props.onRequestSort(t,e)}}render(){const e=this.props,t=e.onSelectAllClick,a=e.order,r=e.orderBy,s=e.numSelected,o=e.rowCount,l=e.columnData;return n.a.createElement(G.a,null,n.a.createElement($.a,null,n.a.createElement(q.a,{padding:"checkbox"},n.a.createElement(Q.a,{indeterminate:s>0&&s<o,checked:s===o,onChange:t})),l.map(e=>n.a.createElement(q.a,{key:e.id,padding:e.disablePadding?"none":"default",sortDirection:r===e.pos&&a},n.a.createElement(ee.a,{title:"Sort",placement:e.numeric?"bottom-end":"bottom-start",enterDelay:300},n.a.createElement(V.a,{active:r===e.pos,direction:a,onClick:this.createSortHandler(e.pos)},e.label))),this)))}}let ce=e=>{const t=e.numSelected,a=e.classes,r=e.name,s=e.handleDeleteItems;return n.a.createElement(d.a,{className:Object(W.a)(a.root,{[a.highlight]:t>0})},n.a.createElement("div",{className:a.title},t>0?n.a.createElement(X.a,{color:"inherit",variant:"subtitle1"},t," selected"):n.a.createElement(X.a,{variant:"h6",id:"tableTitle"},r)),n.a.createElement("div",{className:a.spacer}),n.a.createElement("div",{className:a.actions},t>0?n.a.createElement(ee.a,{title:"Delete"},n.a.createElement(u.a,{"aria-label":"Delete",onClick:s},n.a.createElement(ae.a,null))):n.a.createElement(ee.a,{title:"Add"},n.a.createElement(u.a,{"aria-label":"Add",onClick:e.appStore.setFileUploaderOpen},n.a.createElement(ne.a,null)))))};ce=Object(l.b)("appStore")(Object(S.a)(e=>({root:{paddingRight:e.spacing(1)},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(se.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}))(Object(l.c)(ce)));class ie extends n.a.Component{constructor(e,t){super(e,t),this.handleRequestSort=(e,t)=>{const a=t;let r="desc";this.state.orderBy===t&&"desc"===this.state.order&&(r="asc"),this.setState({order:r,orderBy:a})},this.handleSelectAllClick=(e,t)=>{t?this.setState({selected:this.state.data.map(e=>e.c1)}):this.setState({selected:[]})},this.handleClick=(e,t)=>{const a=this.state.selected,r=a.indexOf(t);let n=[];-1===r?n=n.concat(a,t):0===r?n=n.concat(a.slice(1)):r===a.length-1?n=n.concat(a.slice(0,-1)):r>0&&(n=n.concat(a.slice(0,r),a.slice(r+1))),this.setState({selected:n})},this.handleChangePage=(e,t)=>this.setState({page:t}),this.handleChangeRowsPerPage=e=>this.setState({rowsPerPage:e.target.value}),this.isSelected=e=>-1!==this.state.selected.indexOf(e),this.showResourceEditor=e=>{this.props.appStore.setCurrentResource(e),this.props.appStore.setResourceEditorOpen()},this.handleDeleteItems=e=>this.props.apiStore.delete(this.props.appStore.getCurrentSection(),e),this.state={order:"asc",orderBy:"",selected:[],data:e.data,page:0,rowsPerPage:5}}static getDerivedStateFromProps(e,t){return e.data!==t.data?{data:e.data,selected:[]}:null}render(){const e=this.props,t=e.classes,a=e.columnData,r=e.name,s=e.data,o=this.state,l=o.order,c=o.orderBy,i=o.selected,d=o.rowsPerPage,u=o.page,m=d-Math.min(d,s.length-u*d);return n.a.createElement(Z.a,{className:t.root},n.a.createElement(ce,{name:r,numSelected:i.length,handleDeleteItems:e=>{this.handleDeleteItems(i),this.setState({selected:[]})}}),n.a.createElement("div",{className:t.tableWrapper},n.a.createElement(H.a,{className:t.table,"aria-labelledby":"tableTitle"},n.a.createElement(le,{columnData:a,numSelected:i.length,order:l,orderBy:c,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:s.length}),n.a.createElement(J.a,null,function(e,t){const a=e.map((e,t)=>[e,t]);return a.sort((e,a)=>{const r=t(e[0],a[0]);return 0!==r?r:e[1]-a[1]}),a.map(e=>e[0])}(s,function(e,t){return"desc"===e?(e,a)=>oe(e,a,t):(e,a)=>-oe(e,a,t)}(l,c)).slice(u*d,u*d+d).map(e=>{const a=this.isSelected(e.c1);return n.a.createElement($.a,{hover:!0,role:"checkbox","aria-checked":a,tabIndex:-1,key:e.c1,selected:a},n.a.createElement(q.a,{padding:"checkbox",onClick:t=>this.handleClick(t,e.c1)},n.a.createElement(Q.a,{checked:a})),n.a.createElement(q.a,{onClick:t=>this.showResourceEditor(e.c2),className:t.cursor,component:"th",scope:"row",padding:"none"},e.c3),n.a.createElement(q.a,{onClick:t=>this.showResourceEditor(e.c2),className:t.cursor},e.c4),e.c5&&n.a.createElement(q.a,{onClick:t=>this.showResourceEditor(e.c2),className:t.cursor},e.c5),e.c6&&n.a.createElement(q.a,{onClick:t=>this.showResourceEditor(e.c2),className:t.cursor},e.c6),e.c7&&n.a.createElement(q.a,{onClick:t=>this.showResourceEditor(e.c2),className:t.cursor},e.c7),n.a.createElement(q.a,{onClick:t=>this.showResourceEditor(e.c2),className:t.cursor},e.c1))}),m>0&&n.a.createElement($.a,{style:{height:49*m}},n.a.createElement(q.a,{colSpan:6}))))),n.a.createElement(Y.a,{rowsPerPageOptions:[5,10,25],component:"div",count:s.length,rowsPerPage:d,page:u,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}var de=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)(e=>({root:{width:"100%",marginTop:e.spacing(3)},table:{minWidth:1020},tableWrapper:{overflowX:"auto"},cursor:{cursor:"pointer"}}))(Object(l.c)(ie)))),ue=a(84),me=a.n(ue),pe=(a(166),a(568),a(569),a(570),a(641)),he=a(38),ge=a.n(he),Se=a(653),be=a(642),Ee=a(85),ve=a.n(Ee),fe=a(86),ye=a.n(fe),Ce=a(588),Pe=a(638),we=a(639),ke=a(640);const Oe=Object(S.a)(e=>({root:{borderBottom:"1px solid ".concat(e.palette.divider),margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}))(e=>{const t=e.children,a=e.classes,r=e.onClose;return n.a.createElement(Pe.a,{disableTypography:!0,className:a.root},n.a.createElement(X.a,{variant:"h6"},t),r?n.a.createElement(u.a,{"aria-label":"Close",className:a.closeButton,onClick:r},n.a.createElement(ge.a,null)):null)}),xe=Object(S.a)(e=>({root:{margin:0,padding:0}}))(we.a),Te=Object(S.a)(e=>({root:{borderTop:"1px solid ".concat(e.palette.divider),margin:0,padding:e.spacing(1)}}))(ke.a);class Ne extends n.a.Component{constructor(e){super(e),this.handleTabsChange=(e,t)=>{if(this.setState({tab:t}),0===t)this.setState({resourceYaml:ve.a.stringify(JSON.parse(this.state.resourceJson))});else{const e=JSON.stringify(ye.a.parse(this.state.resourceYaml),null,"\t");this.setState({resourceJson:e})}},this.handleChangeJson=e=>{this.setState({resourceJson:e}),this.setState({jsonEditorAnnotations:this.refs.jsonEditor.editor.getSession().getAnnotations()})},this.handleChangeYaml=e=>{this.setState({resourceYaml:e}),this.setState({yamlEditorAnnotations:this.refs.yamlEditor.editor.getSession().getAnnotations()})},this.saveResource=()=>{try{const e=1===this.state.tab?this.state.resourceJson:JSON.stringify(ye.a.parse(this.state.resourceYaml));this.props.apiStore.update(e),this.props.appStore.setResourceEditorOpen(),this.setState({resource:void 0})}catch(e){this.props.appStore.notify("Malformed document.")}},this.state={tab:0}}UNSAFE_componentWillUpdate(){const e=JSON.parse(this.props.appStore.getCurrentResource());if(!this.state.resource||this.state.resource.metadata.ref!==e.metadata.ref){const t=JSON.stringify(e,null,"\t"),a=ve.a.stringify(e);this.setState({resource:e,resourceJson:t,resourceYaml:a})}}render(){const e=this.state.tab;return n.a.createElement("div",null,n.a.createElement(pe.a,{"aria-labelledby":"customized-dialog-title",onClose:this.props.appStore.setResourceEditorOpen,open:this.props.appStore.isResourceEditorOpen()},n.a.createElement(Oe,{id:"customized-dialog-title",onClose:this.props.appStore.setResourceEditorOpen},"Edit a resource"),n.a.createElement(Se.a,{onChange:this.handleTabsChange,value:e},n.a.createElement(be.a,{label:"YAML"}),n.a.createElement(be.a,{label:"JSON"})),n.a.createElement(xe,null,0===e&&n.a.createElement(me.a,{ref:"yamlEditor",mode:"yaml",theme:"textmate",showGutter:!0,value:this.state.resourceYaml,onChange:this.handleChangeYaml,editorProps:{$blockScrolling:!0}}),1===e&&n.a.createElement(me.a,{ref:"jsonEditor",mode:"json",theme:"textmate",showGutter:!0,value:this.state.resourceJson,onChange:this.handleChangeJson,editorProps:{$blockScrolling:!1}})),n.a.createElement(Te,null,n.a.createElement(Ce.a,{size:"small",variant:"contained",disableElevation:!0,color:"secondary",onClick:this.saveResource},"Save"),n.a.createElement(Ce.a,{size:"small",variant:"contained",disableElevation:!0,onClick:this.props.appStore.setResourceEditorOpen},"Cancel"))))}}var Re=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)({appBar:{position:"relative"},flex:{flex:1}})(Object(l.c)(Ne)))),Ae=a(119),Le=a.n(Ae),je=a(87),De=a(120),ze=a.n(De);function Ie(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))}function Ue(e,t){t||(t=window.location.href),e=e.replace(/[[]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}function Me(e,t,a,r){let n=e+"/"+t;return a&&(n=n+"?filter="+a),r&&(n=a?n+"&token="+r:n+"?token="+r),n}const Be=e=>e&&e.length>0,Fe=e=>!Be(e)||je.ipv4.isValid(e),Ke=e=>!Be(e)||!isNaN(e),_e=e=>!Be(e)||ze()(e),We=e=>!Be(e)||!isNaN(e),He=e=>!Be(e)||!isNaN(e),Je=e=>{if(!Be(e))return!0;const t=e.toString().split("\n");return t.filter(e=>je.ipv4.isSubnet(e)).length===t.length},qe=e=>{if(!Be(e))return!0;return 0===e.split(",").filter(e=>1===e.split("=").length||0===e.split("=")[1].length||!isNaN(e.split("=")[0])).length},Ge=Object(S.a)(e=>({root:{borderBottom:"1px solid ".concat(e.palette.divider),margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}))(e=>{const t=e.children,a=e.classes,r=e.onClose;return n.a.createElement(Pe.a,{disableTypography:!0,className:a.root},n.a.createElement(X.a,{variant:"h6"},t),r?n.a.createElement(u.a,{"aria-label":"Close",className:a.closeButton,onClick:r},n.a.createElement(ge.a,null)):null)}),Ye=Object(S.a)(e=>({root:{margin:0,padding:0}}))(we.a);class $e extends n.a.Component{constructor(...e){super(...e),this.state={oldCnt:0}}render(){const e=this.props,t=e.apiStore,a=e.appStore,r={success:e=>{t.loadResources(a.getCurrentSection()),a.setFileUploaderOpen(),a.notify("Resources added.")},sending:()=>this.setState({oldCnt:t.resources.length}),error:e=>{a.notify("An error occurred while adding resources.")}},s={iconFiletypes:[".yaml",".yml"],showFiletypeIcon:!0,postUrl:Me(t.getAPIUrl(),a.getCurrentSection(),"",t.getToken())};return n.a.createElement("div",null,n.a.createElement(pe.a,{"aria-labelledby":"customized-dialog-title",open:this.props.appStore.isFileUploaderOpen(),onClose:this.props.appStore.setFileUploaderOpen},n.a.createElement(Ge,{id:"customized-dialog-title",onClose:this.props.appStore.setFileUploaderOpen},"Submit Resource File"),n.a.createElement(Ye,{style:{padding:10}},n.a.createElement(Le.a,{eventHandlers:r,djsConfig:{addRemoveLinks:!0},config:s}))))}}var Ve=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)({appBar:{position:"relative"},flex:{flex:1}})(Object(l.c)($e)))),Xe=a(121),Ze=a.n(Xe),Qe=a(643),et=a(645),tt=a(644);var at=Object(l.b)("appStore")(Object(S.a)(e=>({button:{margin:e.spacing(1)},input:{display:"none"},card:{maxWidth:300,position:"relative",margin:"10% auto",padding:8},title:{marginBottom:16,fontSize:14},pos:{marginBottom:12}}))(Object(l.c)((function(e){const t=e.classes,a=e.resource;return n.a.createElement("div",null,n.a.createElement(Qe.a,{justify:"center",className:t.card},n.a.createElement(tt.a,null,n.a.createElement(X.a,{className:t.title,color:"textSecondary"},"No resources found"),n.a.createElement(X.a,{component:"h2"},a),n.a.createElement(X.a,{className:t.pos,color:"textSecondary"},"resource"),n.a.createElement(X.a,{className:t.secondaryHeading},"At this time not resources found on the ",a.toLowerCase()," section. Go to the documentation to learn more about resources ",n.a.createElement("a",{href:"https://routr.io/docs"},n.a.createElement(Ze.a,{style:{color:"#3F51B5",fontSize:18}})))),n.a.createElement(et.a,null,n.a.createElement(Ce.a,{className:t.button,variant:"contained",onClick:e.appStore.setFileUploaderOpen,color:"secondary",size:"small",disableElevation:!0},"Add ",a))))})))),rt=a(51),nt=a.n(rt);const st=[{id:"name",numeric:!1,disablePadding:!0,label:"Domain Name",pos:"c1"},{id:"uri",numeric:!1,disablePadding:!1,label:"URI",pos:"c2"},{id:"modified",numeric:!1,disablePadding:!1,label:"Modified",pos:"c3"},{id:"ref",numeric:!1,disablePadding:!1,label:"Ref",pos:"c4"}];function ot(e){return{c1:e.metadata.ref,c2:JSON.stringify(e),c3:e.metadata.name,c4:e.spec.context.domainUri,c5:nt()(e.metadata.modifiedOn).fromNow()}}const lt=[{id:"name",numeric:!1,disablePadding:!0,label:"Agent Name",pos:"c1"},{id:"username",numeric:!1,disablePadding:!1,label:"Username",pos:"c2"},{id:"modified",numeric:!1,disablePadding:!1,label:"Modified",pos:"c3"},{id:"ref",numeric:!1,disablePadding:!1,label:"Ref",pos:"c4"}];const ct=[{id:"name",numeric:!1,disablePadding:!0,label:"Peer Name",pos:"c1"},{id:"username",numeric:!1,disablePadding:!1,label:"Username",pos:"c2"},{id:"modified",numeric:!1,disablePadding:!1,label:"Modified",pos:"c3"},{id:"ref",numeric:!1,disablePadding:!1,label:"Ref",pos:"c4"}];const it=[{id:"name",numeric:!1,disablePadding:!0,label:"Gateway",pos:"c1"},{id:"username",numeric:!1,disablePadding:!1,label:"Username",pos:"c2"},{id:"host",numeric:!1,disablePadding:!1,label:"Host",pos:"c3"},{id:"modified",numeric:!1,disablePadding:!1,label:"Modified",pos:"c4"},{id:"ref",numeric:!1,disablePadding:!1,label:"Ref",pos:"c5"}];const dt=[{id:"number",numeric:!1,disablePadding:!0,label:"Number",pos:"c1"},{id:"location",numeric:!1,disablePadding:!1,label:"Location",pos:"c2"},{id:"aorLink",numeric:!1,disablePadding:!1,label:"AOR Link",pos:"c3"},{id:"modified",numeric:!1,disablePadding:!1,label:"Modified",pos:"c4"},{id:"ref",numeric:!1,disablePadding:!1,label:"Ref",pos:"c5"}];const ut=[{id:"addressOfRecord",numeric:!1,disablePadding:!0,label:"Address Of Record",pos:"c1"},{id:"contactInfo",numeric:!1,disablePadding:!1,label:"Contact Information",pos:"c2"}];const mt=[{id:"host",numeric:!1,disablePadding:!1,label:"Host",pos:"c1"},{id:"username",numeric:!1,disablePadding:!0,label:"Username",pos:"c2"},{id:"ipAddress",numeric:!1,disablePadding:!1,label:"IP",pos:"c3"},{id:"registered",numeric:!1,disablePadding:!1,label:"Registered",pos:"c4"}];function pt(e){switch(e){case"domains":return st;case"agents":return lt;case"peers":return ct;case"gateways":return it;case"numbers":return dt;case"location":return ut;case"registration":return mt;default:return st}}function ht(e,t){switch(t){case"domains":return ot(e);case"agents":case"peers":return function(e){return{c1:e.metadata.ref,c2:JSON.stringify(e),c3:e.metadata.name,c4:e.spec.credentials.username,c5:nt()(e.metadata.modifiedOn).fromNow()}}(e);case"gateways":return function(e){return{c1:e.metadata.ref,c2:JSON.stringify(e),c3:e.metadata.name,c4:e.spec.credentials&&e.spec.credentials.username?e.spec.credentials.username:"None",c5:e.spec.host,c6:nt()(e.metadata.modifiedOn).fromNow()}}(e);case"numbers":return function(e){let t="";return e.metadata.geoInfo&&(t=e.metadata.geoInfo.city+", "+e.metadata.geoInfo.country),{c1:e.metadata.ref,c2:JSON.stringify(e),c3:e.spec.location.telUrl,c4:t,c5:e.spec.location.aorLink,c6:nt()(e.metadata.modifiedOn).fromNow()}}(e);case"location":return function(e){return{c1:e.addressOfRecord,c2:e.contactInfo}}(e);case"registration":return function(e){return console.log("item:"+JSON.stringify(e)),{c1:e.user,c2:e.host,c3:e.ip,c4:e.regOnFormatted}}(e);default:return ot(e)}}var gt=a(126);class St extends n.a.Component{render(){const e=this.props,t=e.appStore,a=e.apiStore,r=()=>a.getResources().length>0,s=()=>Ie(t.getCurrentSection()),o=pt(t.getCurrentSection()),l=a.getResources();return n.a.createElement("div",null,r()&&n.a.createElement(gt.a,{in:!0},n.a.createElement(de,{hide:!0,name:s(),columnData:o,data:l})),!r()&&n.a.createElement(gt.a,{in:!0},n.a.createElement(at,{resource:s(),handleAddItem:e=>this.setState({fileUploaderOpen:!0})})),n.a.createElement(Re,null),n.a.createElement(Ve,null))}}var bt=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(l.c)(St))),Et=a(646);const vt=e=>({heading:{fontSize:e.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},textField:{marginBottom:10,width:320,marginRight:10},bcLink:{color:e.palette.primary.main,textDecoration:"none","&:hover":{textDecoration:"underline"},display:"flex"},link2:{color:e.palette.primary.main,textDecoration:"none","&:hover":{textDecoration:"underline"},display:"flex"},root:{marginBottom:e.spacing(2)},link:{display:"flex",marginTop:5},icon:{marginRight:e.spacing(.5),width:20,height:20}});var ft=Object(S.a)(vt)((function(e){const t=e.onChangeSection,a=e.classes,r=(e,a)=>{e.preventDefault(),t(a)};return n.a.createElement("div",null,n.a.createElement(Et.a,{color:"secondary",href:"/",onClick:e=>r(e,"general"),className:a.link},"General"),n.a.createElement(Et.a,{color:"secondary",onClick:e=>r(e,"networking_and_transport"),href:"/",className:a.link},"Networking and Transport"),n.a.createElement(Et.a,{color:"secondary",onClick:e=>r(e,"nat"),href:"/",className:a.link},"NAT"),n.a.createElement(Et.a,{color:"secondary",onClick:e=>r(e,"access_control_lists"),href:"/",className:a.link},"Access Control Lists"),n.a.createElement(Et.a,{color:"secondary",onClick:e=>r(e,"data_access"),href:"/",className:a.link},"Data Access"),n.a.createElement(Et.a,{color:"secondary",onClick:e=>r(e,"rest_service"),href:"/",className:a.link},"Rest Service"),n.a.createElement(Et.a,{color:"secondary",onClick:e=>r(e,"certificates"),href:"/",className:a.link},"Certificates"),n.a.createElement(Et.a,{color:"secondary",onClick:e=>r(e,"danger_zone"),href:"/",className:a.link},"Danger Zone"))})),yt=a(658);var Ct=Object(S.a)(vt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(X.a,{className:o.secondaryHeading},"Sets the SIP header User-Agent to the desired value. ",n.a.createElement("br",null)," If not value is provided, the server will use ",n.a.createElement("em",null,"`Routr $version.`")),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"userAgent",label:"User Agent",multiline:!0,rowsMax:"4",value:r.userAgent,onChange:s,className:o.textField,size:"small",variant:"outlined",placeholder:"Routr v1.0"}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(Ce.a,{onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(Ce.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))}));var Pt=Object(S.a)(vt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(X.a,{className:o.secondaryHeading},"This is the default IP address for the SIP stack. ",n.a.createElement("br",null),"All Sip traffic will be routed through this interface."),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"bindAddr",label:"Bind Address",value:r.bindAddr,onChange:s,className:o.textField,error:!Fe(r.bindAddr),variant:"outlined",size:"small",placeholder:"192.168.1.12"}),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"udpPort",label:"UDP Port",onChange:s,className:o.textField,value:r.transportPorts.udp,error:!Ke(r.transportPorts.udp),variant:"outlined",size:"small",placeholder:"5060",inputProps:{maxLength:5}}),n.a.createElement("br",null),n.a.createElement(X.a,{className:o.secondaryHeading},"You can use the same port number for both TCP",n.a.createElement("br",null)," and UDP."),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"tcpPort",label:"TCP Port",onChange:s,className:o.textField,value:r.transportPorts.tcp,error:!Ke(r.transportPorts.tcp),variant:"outlined",size:"small",placeholder:"5060",inputProps:{maxLength:5}}),n.a.createElement("br",null),n.a.createElement(X.a,{className:o.secondaryHeading},"Secure transport, like TLS and WSS, required",n.a.createElement("br",null),"a valid certificate to secure the SIP signaling."),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"tlsPort",label:"TLS Port",onChange:s,className:o.textField,value:r.transportPorts.tls,error:!Ke(r.transportPorts.tls),variant:"outlined",size:"small",placeholder:"5061",inputProps:{maxLength:5}}),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"wsPort",label:"WS Port",onChange:s,className:o.textField,value:r.transportPorts.ws,error:!Ke(r.transportPorts.ws),variant:"outlined",size:"small",placeholder:"5062",inputProps:{maxLength:5}}),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"wssPort",label:"WSS Port",onChange:s,className:o.textField,value:r.transportPorts.wss,error:!Ke(r.transportPorts.wss),variant:"outlined",size:"small",placeholder:"5063",inputProps:{maxLength:5}}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(Ce.a,{disabled:!(Fe(r.bindAddr)&&Ke(r.transportPorts.udp)&&Ke(r.transportPorts.tcp)&&Ke(r.transportPorts.tls)&&Ke(r.transportPorts.ws)&&Ke(r.transportPorts.wss)),onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(Ce.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))})),wt=a(647),kt=a(664),Ot=a(655),xt=a(648);var Tt=Object(S.a)(vt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(X.a,{className:o.secondaryHeading},"The IP address to advertise. This must be used",n.a.createElement("br",null),"in combination with Localnets. If Localnets is",n.a.createElement("br",null)," empty, the External Address will be ignored."),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"externAddr",label:"External Address",value:r.externAddr,onChange:s,className:o.textField,error:!Fe(r.externAddr),variant:"outlined",size:"small",placeholder:"172.220.246.46"}),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"localnets",label:"Localnets",multiline:!0,rowsMax:"4",rows:"3",value:r.localnets,onChange:s,error:!Je(r.localnets),className:o.textField,variant:"outlined",size:"small",placeholder:"192.168.1.149/32"}),n.a.createElement("br",null),n.a.createElement(X.a,{className:o.secondaryHeading},"Choosing Internal causes the server to use the",n.a.createElement("br",null),' IP and port it "sees"(received & rport) from a ',n.a.createElement("br",null)," device attempting to register. You will rarely need",n.a.createElement("br",null)," to change this!"),n.a.createElement("br",null),n.a.createElement(wt.a,{size:"small",variant:"outlined",className:o.textField},n.a.createElement(kt.a,null,"Registration Interface"),n.a.createElement(Ot.a,{value:r.registrarIntf,onChange:s,labelWidth:155,size:"small"},n.a.createElement(h.a,{id:"registrarIntf",value:"Internal"},n.a.createElement("em",null,"Internal")),n.a.createElement(h.a,{id:"registrarIntf",value:"External"},"External"))),n.a.createElement("br",null),n.a.createElement(xt.a,{control:n.a.createElement(Q.a,{id:"recordRoute",onChange:s,checked:r.recordRoute,color:"primary",size:"small"}),label:"Record-Route"}),n.a.createElement("br",null),n.a.createElement(X.a,{variant:"caption"},"Check if you want server to stay within the signaling path",n.a.createElement("br",null),n.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://routr.io/docs/configuration/general/",className:o.link2},"Learn more")),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(Ce.a,{disabled:!(Fe(r.externAddr)&&Je(r.localnets)),onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(Ce.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))})),Nt=a(52),Rt=a(650),At=a(122),Lt=a.n(At),jt=a(651),Dt=a(583),zt=a(586),It=a(659),Ut=a(652),Mt=a(124),Bt=a(649);const Ft=["Restart Server Now","Restart Server","Stop Server Now","Stop Server"];var Kt=Object(S.a)(vt)((function(e){const t=n.a.useState(!1),a=Object(Nt.a)(t,2),r=a[0],s=a[1],o=n.a.useState(!1),l=Object(Nt.a)(o,2),c=l[0],i=l[1],d=n.a.useState(""),u=Object(Nt.a)(d,2),m=u[0],p=u[1],g=n.a.useState(""),S=Object(Nt.a)(g,2),b=S[0],E=S[1],v=n.a.useState(1),f=Object(Nt.a)(v,2),y=f[0],C=f[1],P=n.a.useRef(null),w=e.onRestartServerNow,k=e.onStopServerNow,O=e.onRestartServer,x=e.onStopServer,T=e.classes,N=()=>{i(!1)},R=e=>{P.current&&P.current.contains(e.target)||s(!1)},A=Object(Mt.a)({palette:{error:{main:"#fafafa"}}});return n.a.createElement("div",null,n.a.createElement(X.a,{className:T.secondaryHeading},"Before restarting or stopping the server be sure to check your ",n.a.createElement("br",null),'configurations. If you chose an action with "NOW" it will drop all ',n.a.createElement("br",null),"active calls and inmediatly restart or stop the server."),n.a.createElement("br",null),n.a.createElement(Bt.a,{theme:A},n.a.createElement(Rt.a,{variant:"outlined",color:"secondary",ref:P,"aria-label":"split button"},n.a.createElement(Ce.a,{onClick:()=>{p(Ft[y].toUpperCase()),i(!0)}},Ft[y]),n.a.createElement(Ce.a,{color:"secondary",size:"small","aria-controls":r?"split-button-menu":void 0,"aria-expanded":r?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",onClick:()=>{s(e=>!e)}},n.a.createElement(Lt.a,null)))),n.a.createElement(zt.a,{open:r,anchorEl:P.current,role:void 0,transition:!0,disablePortal:!0},({TransitionProps:e,placement:t})=>n.a.createElement(Dt.a,Object.assign({},e,{style:{transformOrigin:"bottom"===t?"center top":"center bottom"}}),n.a.createElement(Z.a,null,n.a.createElement(jt.a,{onClickAway:R},n.a.createElement(It.a,{id:"split-button-menu"},Ft.map((e,t)=>n.a.createElement(h.a,{key:e,selected:t===y,onClick:e=>((e,t)=>{C(t),s(!1)})(0,t)},e))))))),n.a.createElement(pe.a,{open:c,onClose:N,"aria-labelledby":"form-dialog-title"},n.a.createElement(Pe.a,{id:"form-dialog-title"},"Are you sure?"),n.a.createElement(we.a,null,n.a.createElement(Ut.a,{className:T.secondaryHeading},"Last chance. A signal will be send to your Routr instance and the UI will be temporarily unresponsive. Some changes can render your server inoperable. Proceed with caution!"),n.a.createElement(yt.a,{autoFocus:!0,margin:"dense",id:"name",onChange:e=>E(e.target.value),label:"Please type ".concat(m," to continue"),type:"email",fullWidth:!0})),n.a.createElement(ke.a,null,n.a.createElement(Ce.a,{onClick:N,color:"primary"},"Cancel"),n.a.createElement(Ce.a,{disabled:!(m===b),onClick:()=>{switch(y){case 0:w();break;case 1:O();break;case 2:k();break;case 3:x()}i(!1)},color:"primary"},"Continue"))))}));var _t=Object(S.a)(vt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(X.a,{className:o.secondaryHeading},"The recommended provider for production is",n.a.createElement("br",null),n.a.createElement("em",null,"redis_data_provider.")),n.a.createElement("br",null),n.a.createElement(wt.a,{size:"small",variant:"outlined",className:o.formControl},n.a.createElement(kt.a,null,"Data Source Provider"),n.a.createElement(Ot.a,{labelId:"demo-simple-select-outlined-label",value:r.dsProvider,onChange:s,labelWidth:155},n.a.createElement(h.a,{id:"dsProvider",value:"files_data_provider"},n.a.createElement("em",null,"Files Data Source")),n.a.createElement(h.a,{id:"dsProvider",value:"redis_data_provider"},"Redis Data Provider"))),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"dsParameters",label:"Data Source Parameters",value:r.dsParameters,onChange:s,className:o.textField,error:!qe(r.dsParameters),variant:"outlined",size:"small",placeholder:"host=localhost,port=6379"}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(Ce.a,{disabled:!qe(r.dsParameters),onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(Ce.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))}));var Wt=Object(S.a)(vt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(X.a,{className:o.secondaryHeading},"This is the default IP address for the Rest service. ",n.a.createElement("br",null)," All HTTP traffic will be routed through this interface."),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"restBindAddr",label:"Bind Address",value:r.restBindAddr,onChange:s,className:o.textField,error:!Fe(r.restBindAddr),variant:"outlined",size:"small",placeholder:"0.0.0.0"}),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"restPort",label:"HTTP Port",onChange:s,className:o.textField,value:r.restPort,error:!Ke(r.restPort),variant:"outlined",size:"small",placeholder:"4567"}),n.a.createElement("br",null),n.a.createElement(X.a,{className:o.secondaryHeading},"Minimum thread allocation. Defaults to 8."),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"restMinThreads",label:"Minimum Threads",onChange:s,className:o.textField,value:r.restMinThreads,variant:"outlined",size:"small",error:!He(r.restMinThreads),placeholder:"8"}),n.a.createElement("br",null),n.a.createElement(X.a,{className:o.secondaryHeading},"Maximum thread allocation. Defaults to 200."),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"restMaxThreads",label:"Maximum Threads",onChange:s,className:o.textField,value:r.restMaxThreads,error:!He(r.restMaxThreads),variant:"outlined",size:"small",placeholder:"200"}),n.a.createElement("br",null),n.a.createElement(X.a,{className:o.secondaryHeading},"Will reject requests that last more than the timeout. ",n.a.createElement("br",null),"Defaults to 5000(5 seconds.)"),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"restTimeOutMillis",label:"Request Timeout",onChange:s,className:o.textField,value:r.restTimeOutMillis,error:!We(r.restTimeOutMillis),variant:"outlined",size:"small",placeholder:"5000"}),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"restKeyStorePath",label:"KeyStore Path",onChange:s,className:o.textField,value:r.restKeyStorePath,variant:"outlined",size:"small",placeholder:"/etc/certificates/api-cert.jks"}),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"restTrustStorePath",label:"TrustStore Path",onChange:s,className:o.textField,value:r.restTrustStorePath,variant:"outlined",size:"small",placeholder:"/etc/certificates/api-cert.jks"}),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"restKeyStorePassword",label:"KeyStore Password",onChange:s,className:o.textField,value:r.restKeyStorePassword,variant:"outlined",type:"password",size:"small"}),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"restTrustStorePassword",label:"TrustStore Password",onChange:s,className:o.textField,value:r.restTrustStorePassword,variant:"outlined",type:"password",size:"small"}),n.a.createElement("br",null),n.a.createElement(xt.a,{control:n.a.createElement(Q.a,{id:"restUnsecured",onChange:s,checked:r.restUnsecured,color:"primary",size:"small"}),label:"Allow Unsecured"}),n.a.createElement("br",null),n.a.createElement(X.a,{variant:"caption"},"Check if you want to enable unsecured connections with",n.a.createElement("br",null),"the APIs. Not recommended in production.",n.a.createElement("br",null),n.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://routr.io/docs/configuration/general/",className:o.link2},"Learn more")),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(Ce.a,{disabled:!(Fe(r.restBindAddr)&&Ke(r.restPort)&&He(r.restMinThreads)&&He(r.restMaxThreads)&&_e(r.restKeyStorePath)&&_e(r.restTrustStorePath)&&We(r.restTimeOutMillis)),onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(Ce.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))}));var Ht=Object(S.a)(vt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(X.a,{className:o.secondaryHeading},"This configurations affect all your domains."),n.a.createElement("br",null),n.a.createElement(wt.a,{size:"small",variant:"outlined",className:o.textField},n.a.createElement(kt.a,null,"Client Authentication Type"),n.a.createElement(Ot.a,{value:r.scClientAuthType,onChange:s,labelWidth:200,size:"small"},n.a.createElement(h.a,{id:"scClientAuthType",value:"DisabledAll"},n.a.createElement("em",null,"DisabledAll")),n.a.createElement(h.a,{id:"scClientAuthType",value:"Disabled"},"Disabled"),n.a.createElement(h.a,{id:"scClientAuthType",value:"Enabled"},"Enabled"),n.a.createElement(h.a,{id:"scClientAuthType",value:"Want"},"Want"))),n.a.createElement("br",null),n.a.createElement(wt.a,{size:"small",variant:"outlined",className:o.textField},n.a.createElement(kt.a,null,"KeyStore Type"),n.a.createElement(Ot.a,{value:r.scKeyStoreType,onChange:s,labelWidth:200,size:"small"},n.a.createElement(h.a,{id:"scKeyStoreType",value:"jks"},n.a.createElement("em",null,"JKS")),n.a.createElement(h.a,{id:"scKeyStoreType",value:"pkcs12"},"PKCS12"))),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"scKeyStorePath",label:"KeyStore Path",onChange:s,className:o.textField,value:r.scKeyStorePath,error:!_e(r.scKeyStorePath),variant:"outlined",size:"small",placeholder:"/etc/certificates/domain-cert.jks"}),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"scTrustStorePath",label:"TrustStore Path",onChange:s,className:o.textField,value:r.scTrustStorePath,error:!_e(r.scTrustStorePath),variant:"outlined",size:"small",placeholder:"/etc/certificates/domain-cert.jks"}),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"scKeyStorePassword",label:"KeyStore Password",onChange:s,className:o.textField,value:r.scKeyStorePassword,variant:"outlined",type:"password",size:"small"}),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"scTrustStorePassword",label:"TrustStore Password",onChange:s,className:o.textField,value:r.scTrustStorePassword,variant:"outlined",type:"password",size:"small"}),n.a.createElement("br",null),n.a.createElement(X.a,{className:o.secondaryHeading},"TLS Support"),n.a.createElement(xt.a,{style:{marginLeft:10},control:n.a.createElement(Q.a,{id:"scSSLv3",onChange:s,checked:r.scSSLv3,color:"primary",size:"small"}),label:"SSLv3"}),n.a.createElement("br",null),n.a.createElement(xt.a,{style:{marginLeft:10},control:n.a.createElement(Q.a,{id:"scTLSv1",onChange:s,checked:r.scTLSv1,color:"primary",size:"small"}),label:"TLSv1"}),n.a.createElement("br",null),n.a.createElement(xt.a,{style:{marginLeft:10},control:n.a.createElement(Q.a,{id:"scTLSv11",onChange:s,checked:r.scTLSv11,color:"primary",size:"small"}),label:"TLSv1.1"}),n.a.createElement("br",null),n.a.createElement(xt.a,{style:{marginLeft:10},control:n.a.createElement(Q.a,{id:"scTLSv12",onChange:s,checked:r.scTLSv12,color:"primary",size:"small"}),label:"TLSv1.2"}),n.a.createElement("br",null),n.a.createElement(xt.a,{control:n.a.createElement(Q.a,{id:"scDebugging",onChange:s,checked:r.scDebugging,color:"primary",size:"small"}),label:"Enable Debugging"}),n.a.createElement("br",null),n.a.createElement(X.a,{variant:"caption"},"Check if you want to enable debugging for secured",n.a.createElement("br",null),"connections. Not recommended in production.",n.a.createElement("br",null),n.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://routr.io/docs/configuration/general/",className:o.link2},"Learn more")),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(Ce.a,{disabled:!(_e(r.scKeyStorePath)&&_e(r.scTrustStorePath)),onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(Ce.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))}));var Jt=Object(S.a)(vt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(X.a,{className:o.secondaryHeading},"Denies or allows incoming traffic from the network list. ",n.a.createElement("br",null),'The "Deny Subnets" takes precedence over the ',n.a.createElement("br",null),' "Allow Subnets."'),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"aclDeny",label:"Deny Subnets",multiline:!0,rowsMax:"4",rows:"3",value:r.aclDeny,onChange:s,error:!Je(r.aclDeny),className:o.textField,variant:"outlined",size:"small",placeholder:"0.0.0.0/1"}),n.a.createElement("br",null),n.a.createElement(yt.a,{id:"aclAllow",label:"Allow Subnets",multiline:!0,rowsMax:"4",rows:"3",value:r.aclAllow,onChange:s,error:!Je(r.aclAllow),className:o.textField,variant:"outlined",size:"small",placeholder:"192.168.1.12/32"}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(Ce.a,{disabled:!(Je(r.aclDeny)&&Je(r.aclAllow)),onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(Ce.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))})),qt=a(656);var Gt=Object(S.a)(vt)((function(e){const t=e.onChangeSection,a=e.currentSection,r=e.classes;return n.a.createElement("div",{className:r.root},n.a.createElement(qt.a,{"aria-label":"breadcrumb"},n.a.createElement(Et.a,{color:"inherit",href:"/",onClick:e=>((e,a)=>{e.preventDefault(),t(a)})(e,"home"),className:r.bcLink},n.a.createElement(O.a,{className:r.icon}),"Settings"),"home"!==a&&n.a.createElement(X.a,{color:"textPrimary"},{home:"General",general:"General",networking_and_transport:"Networking and Transport",nat:"NAT",certificates:"Certificates",access_control_lists:"Access Control Lists",rest_service:"Rest Service",data_access:"Data Access",danger_zone:"Danger Zone"}[a])))}));class Yt extends n.a.Component{constructor(e){super(e),this.handleSave=()=>{const e=e=>e&&e.length>0,t=this.state.config,a=this.state;t.spec.dataSource||(t.spec.dataSource={}),(t=>e(t.aclAllow)||e(t.aclDeny))(a)?t.spec.accessControlList={}:delete t.spec.accessControlList,t.metadata||(t.metadata={}),a.localnets&&(t.spec.localnets=a.localnets.toString().split("\n")),e(a.aclDeny)&&(t.spec.accessControlList.deny=a.aclDeny.toString().split("\n")),e(a.aclAllow)&&(t.spec.accessControlList.allow=a.aclAllow.toString().split("\n")),t.metadata.userAgent=a.userAgent,t.spec.bindAddr=a.bindAddr,t.spec.externAddr=a.externAddr,t.spec.registrarIntf=a.registrarIntf,t.spec.recordRoute=a.recordRoute,t.spec.dataSource.provider=a.dsProvider,t.spec.dataSource.parameters=a.dsParameters,t.spec.restService.bindAddr=a.restBindAddr,t.spec.restService.keyStore=a.restKeyStorePath,t.spec.restService.trustStore=a.restTrustStorePath,t.spec.restService.keyStorePassword=a.restKeyStorePassword,t.spec.restService.trustStorePassword=a.restTrustStorePassword,t.spec.restService.unsecured=a.restUnsecured,t.spec.securityContext.keyStore=a.scKeyStorePath,t.spec.securityContext.trustStore=a.scTrustStorePath,t.spec.securityContext.keyStorePassword=a.scKeyStorePassword,t.spec.securityContext.trustStorePassword=a.scTrustStorePassword,t.spec.securityContext.debugging=a.scDebugging,t.spec.securityContext.client.authType=a.scClientAuthType,t.spec.securityContext.keyStoreType=a.scKeyStoreType,a.restPort?t.spec.restService.port=parseInt(a.restPort):delete t.spec.restService.port,a.restMinThreads?t.spec.restService.minThreads=parseInt(a.restMinThreads):delete t.spec.restService.minThreads,a.restMaxThreads?t.spec.restService.maxThreads=parseInt(a.restMaxThreads):delete t.spec.restService.maxThreads,a.restTimeOutMillis?t.spec.restService.timeOutMillis=parseInt(a.restTimeOutMillis):delete t.spec.restService.timeOutMillis;const r=[];a.scTLSv1&&r.push("TLSv1"),a.scTLSv11&&r.push("TLSv1.1"),a.scTLSv12&&r.push("TLSv1.2"),a.scSSLv3&&r.push("SSLv3"),t.spec.securityContext.client.protocols=r;const n=[],s=this.state.transportPorts;s.udp&&n.push({protocol:"udp",port:parseInt(s.udp)}),s.tcp&&n.push({protocol:"tcp",port:parseInt(s.tcp)}),s.tls&&n.push({protocol:"tls",port:parseInt(s.tls)}),s.ws&&n.push({protocol:"ws",port:parseInt(s.ws)}),s.wss&&n.push({protocol:"wss",port:parseInt(s.wss)}),t.spec.transport=n,this.props.apiStore.saveConfig(t),this.setState({currentSection:"home"})},this.handleOnCancel=()=>this.setState({currentSection:"home",updated:!1}),this.isSection=e=>this.state.currentSection===e,this.handleChangeSection=e=>this.setState({currentSection:e,updated:!1}),this.handleChange=e=>{const t=e.currentTarget.id,a=e.target.value,r=this.state.transportPorts;"userAgent"===t&&this.setState({userAgent:a}),"bindAddr"===t&&this.setState({bindAddr:a}),"externAddr"===t&&this.setState({externAddr:a}),"localnets"===t&&this.setState({localnets:a}),"dsProvider"===t&&this.setState({dsProvider:a}),"dsParameters"===t&&this.setState({dsParameters:a}),"registrarIntf"===t&&this.setState({registrarIntf:a}),"aclDeny"===t&&this.setState({aclDeny:a}),"aclAllow"===t&&this.setState({aclAllow:a}),"recordRoute"===t&&this.setState({recordRoute:e.target.checked}),"udpPort"===t&&(r.udp=a,this.setState({transportPorts:r})),"tcpPort"===t&&(r.tcp=a,this.setState({transportPorts:r})),"tlsPort"===t&&(r.tls=a,this.setState({transportPorts:r})),"wsPort"===t&&(r.ws=a,this.setState({transportPorts:r})),"wssPort"===t&&(r.wss=a,this.setState({transportPorts:r})),"restBindAddr"===t&&this.setState({restBindAddr:a}),"restPort"===t&&this.setState({restPort:a}),"restMinThreads"===t&&this.setState({restMinThreads:a}),"restMaxThreads"===t&&this.setState({restMaxThreads:a}),"restTimeOutMillis"===t&&this.setState({restTimeOutMillis:a}),"restKeyStorePath"===t&&this.setState({restKeyStorePath:a}),"restTrustStorePath"===t&&this.setState({restTrustStorePath:a}),"restKeyStorePassword"===t&&this.setState({restKeyStorePassword:a}),"restTrustStorePassword"===t&&this.setState({restTrustStorePassword:a}),"restUnsecured"===t&&this.setState({restUnsecured:e.target.checked}),"scKeyStorePath"===t&&this.setState({scKeyStorePath:a}),"scTrustStorePath"===t&&this.setState({scTrustStorePath:a}),"scKeyStorePassword"===t&&this.setState({scKeyStorePassword:a}),"scTrustStorePassword"===t&&this.setState({scTrustStorePassword:a}),"scClientAuthType"===t&&this.setState({scClientAuthType:a}),"scKeyStoreType"===t&&this.setState({scKeyStoreType:a}),"scDebugging"===t&&this.setState({scDebugging:e.target.checked}),"scTLSv1"===t&&this.setState({scTLSv1:e.target.checked}),"scTLSv11"===t&&this.setState({scTLSv11:e.target.checked}),"scTLSv12"===t&&this.setState({scTLSv12:e.target.checked}),"scSSLv3"===t&&this.setState({scSSLv3:e.target.checked})},this.handleRestartServerNow=()=>{this.props.apiStore.changeStatus("restarting",!0)},this.handleRestartServer=()=>{this.props.apiStore.changeStatus("restarting",!1)},this.handleStopServerNow=()=>{this.props.apiStore.changeStatus("down",!0)},this.handleStopServer=()=>{this.props.apiStore.changeStatus("down",!1)},this.state={updated:!1,config:{},currentSection:"home",userAgent:"",bindAddr:"",externAddr:"",localnets:"",transportPorts:{udp:"",tcp:"",tls:"",ws:"",wss:""},registrarIntf:"Internal",recordRoute:!1,aclDeny:"",aclAllow:"",dsProvider:"files_data_provider",dsParameters:"",restBindAddr:"",restPort:"",restMinThreads:"",restMaxThreads:"",restTimeOutMillis:"",restKeyStorePath:"",restTrustStorePath:"",restKeyStorePassword:"",restTrustStorePassword:"",scKeyStorePath:"",scTrustStorePath:"",scKeyStorePassword:"",scTrustStorePassword:"",scKeyStoreType:"",scDebugging:!1,scClientAuthType:"DisabledAll",scSSLv3:!1,scTLSv1:!1,scTLSv11:!1,scTLSv12:!1,restUnsecured:!1}}componentDidUpdate(e){if(!0===this.state.updated)return;let t=e.apiStore.getConfig(),a="",r="",n="",s="";t=t||{},t.spec=t.spec||{},t.metadata=t.metadata||{},t.spec.transport=t.spec.transport||[],t.spec.securityContext=t.spec.securityContext||{},t.spec.securityContext.client=t.spec.securityContext.client||{},t.spec.securityContext.client.protocols=t.spec.securityContext.client.protocols||[],t.spec.restService=t.spec.restService||{},t.spec.dataSource&&(a=t.spec.dataSource.provider,r=t.spec.dataSource.parameters),t.spec.accessControlList&&t.spec.accessControlList.allow&&(s=t.spec.accessControlList.allow.join("\n")),t.spec.accessControlList&&t.spec.accessControlList.deny&&(n=t.spec.accessControlList.deny.join("\n"));const o={};t.spec.transport.forEach(e=>{o[e.protocol]=e.port});const l=t.spec.securityContext.client.protocols.filter(e=>"TLSv1"===e).length>0,c=t.spec.securityContext.client.protocols.filter(e=>"TLSv1.1"===e).length>0,i=t.spec.securityContext.client.protocols.filter(e=>"TLSv1.2"===e).length>0,d=t.spec.securityContext.client.protocols.filter(e=>"SSLv3"===e).length>0;this.setState({userAgent:t.metadata.userAgent,bindAddr:t.spec.bindAddr,externAddr:t.spec.externAddr,localnets:t.spec.localnets,registrarIntf:t.spec.registrarIntf,recordRoute:t.spec.recordRoute,restBindAddr:t.spec.restService.bindAddr,restPort:t.spec.restService.port,restMinThreads:t.spec.restService.minThreads,restMaxThreads:t.spec.restService.maxThreads,restTimeOutMillis:t.spec.restService.timeOutMillis,restKeyStorePath:t.spec.restService.keyStore,restTrustStorePath:t.spec.restService.trustStore,restKeyStorePassword:t.spec.restService.keyStorePassword,restTrustStorePassword:t.spec.restService.trustStorePassword,restUnsecured:t.spec.restService.unsecured,scKeyStorePath:t.spec.securityContext.keyStore,scTrustStorePath:t.spec.securityContext.trustStore,scKeyStorePassword:t.spec.securityContext.keyStorePassword,scTrustStorePassword:t.spec.securityContext.trustStorePassword,scClientAuthType:t.spec.securityContext.client.authType,scKeyStoreType:t.spec.securityContext.keyStoreType,scDebugging:t.spec.securityContext.debugging,scTLSv1:l,scTLSv11:c,scTLSv12:i,scSSLv3:d,dsParameters:r,dsProvider:a,aclDeny:n,aclAllow:s,config:t,updated:!0,transportPorts:o})}render(e){return n.a.createElement("div",null,n.a.createElement(Gt,{onChangeSection:this.handleChangeSection,currentSection:this.state.currentSection}),this.isSection("general")&&n.a.createElement(Ct,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),this.isSection("nat")&&n.a.createElement(Tt,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),this.isSection("access_control_lists")&&n.a.createElement(Jt,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),this.isSection("networking_and_transport")&&n.a.createElement(Pt,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),this.isSection("rest_service")&&n.a.createElement(Wt,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),this.isSection("certificates")&&n.a.createElement(Ht,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),this.isSection("data_access")&&n.a.createElement(_t,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),"home"===this.state.currentSection&&n.a.createElement(ft,{onChangeSection:this.handleChangeSection}),this.isSection("danger_zone")&&n.a.createElement(Kt,{onRestartServerNow:this.handleRestartServerNow,onStopServerNow:this.handleStopServerNow,onRestartServer:this.handleRestartServer,onStopServer:this.handleStopServer}))}}var $t=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(l.c)(Yt))),Vt=a(660);class Xt extends n.a.Component{constructor(...e){super(...e),this.handleClose=()=>this.props.appStore.setNotificationOpen()}render(){return n.a.createElement("div",null,n.a.createElement(Vt.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:this.props.appStore.isNotificationOpen(),autoHideDuration:15e3,onClose:this.handleClose,ContentProps:{"aria-describedby":"message-id"},message:n.a.createElement("span",{id:"message-id"},this.props.appStore.notificationMsg),action:[n.a.createElement(u.a,{key:"close","aria-label":"Close",color:"inherit",onClick:this.handleClose},n.a.createElement(ge.a,null))]}))}}var Zt=Object(l.b)("appStore")(Object(l.c)(Xt)),Qt=a(123),ea=a.n(Qt);class ta extends n.a.Component{constructor(...e){super(...e),this.createSortHandler=e=>t=>{this.props.onRequestSort(t,e)}}render(){const e=this.props,t=e.order,a=e.orderBy,r=e.columnData;return n.a.createElement(G.a,null,n.a.createElement($.a,null,r.map(e=>n.a.createElement(q.a,{key:e.id,sortDirection:a===e.id&&t},n.a.createElement(ee.a,{title:"Sort",placement:e.numeric?"bottom-end":"bottom-start",enterDelay:300},n.a.createElement(V.a,{active:a===e.id,direction:t,onClick:this.createSortHandler(e.id)},e.label))),this)))}}let aa=e=>{const t=e.classes,a=e.name,r=e.handleRefresh;return n.a.createElement(d.a,null,n.a.createElement("div",{className:t.title},n.a.createElement(X.a,{variant:"h6",id:"tableTitle"},Ie(a))),n.a.createElement("div",{className:t.spacer}),n.a.createElement("div",{className:t.actions},n.a.createElement(ee.a,{title:"Refresh"},n.a.createElement(u.a,{"aria-label":"Refresh",onClick:r},n.a.createElement(ea.a,null)))))};aa=Object(S.a)(e=>({root:{paddingRight:e.spacing(1)},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(se.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}))(aa);class ra extends n.a.Component{constructor(e){super(e),this.handleRequestSort=(e,t)=>{const a=t;let r="desc";this.state.orderBy===t&&"desc"===this.state.order&&(r="asc");const n="desc"===r?this.state.data.sort((e,t)=>t[a]<e[a]?-1:1):this.state.data.sort((e,t)=>e[a]<t[a]?-1:1);this.setState({data:n,order:r,orderBy:a})},this.handleChangePage=(e,t)=>{this.setState({page:t})},this.handleChangeRowsPerPage=e=>{this.setState({rowsPerPage:e.target.value})},this.state={order:"asc",orderBy:"calories",data:e.data,page:0,rowsPerPage:5}}render(){const e=this.props,t=e.classes,a=e.columnData,r=e.data,s=e.name,o=e.apiStore,l=this.state,c=l.order,i=l.orderBy,d=l.rowsPerPage,u=l.page,m=d-Math.min(d,r.length-u*d);return n.a.createElement(Z.a,{className:t.root},n.a.createElement(aa,{name:s,handleRefresh:e=>o.loadResources(this.props.appStore.getCurrentSection())}),n.a.createElement("div",{className:t.tableWrapper},n.a.createElement(H.a,{className:t.table,"aria-labelledby":"tableTitle"},n.a.createElement(ta,{columnData:a,order:c,orderBy:i,onRequestSort:this.handleRequestSort}),n.a.createElement(J.a,null,r.slice(u*d,u*d+d).map(e=>n.a.createElement($.a,{hover:!0,tabIndex:-1,key:e.c1},n.a.createElement(q.a,{component:"th",scope:"row"},e.c1),n.a.createElement(q.a,null,e.c2),e.c3&&n.a.createElement(q.a,null,e.c3),e.c4&&n.a.createElement(q.a,null,e.c4))),m>0&&n.a.createElement($.a,{style:{height:49*m}},n.a.createElement(q.a,{colSpan:6}))))),n.a.createElement(Y.a,{component:"div",count:r.length,rowsPerPage:d,page:u,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}var na=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)(e=>({root:{width:"100%",marginTop:e.spacing(1)},table:{minWidth:1020},tableWrapper:{overflowX:"auto"}}))(Object(l.c)(ra))));const sa=Object(S.a)(e=>({root:{borderBottom:"1px solid ".concat(e.palette.divider),margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}))(e=>{const t=e.children,a=e.classes,r=e.onClose;return n.a.createElement(Pe.a,{disableTypography:!0,className:a.root},n.a.createElement(X.a,{variant:"h6"},t),r?n.a.createElement(u.a,{"aria-label":"Close",className:a.closeButton,onClick:r},n.a.createElement(ge.a,null)):null)}),oa=Object(S.a)(e=>({root:{margin:0,padding:0}}))(we.a);class la extends n.a.Component{render(){return n.a.createElement("div",null,n.a.createElement(pe.a,{"aria-labelledby":"customized-dialog-title",onClose:this.props.appStore.setAboutDialogOpen,open:this.props.appStore.isAboutDialogOpen()},n.a.createElement(sa,{id:"customized-dialog-title",onClose:this.props.appStore.setAboutDialogOpen},"About"),n.a.createElement(oa,null,n.a.createElement(tt.a,null,n.a.createElement(X.a,{color:"textSecondary"},"v1.0"),n.a.createElement(X.a,{component:"p"},'Routr is a lightweight sip proxy, location server, and registrar that provides a reliable and scalable SIP infrastructure for telephony carriers, communication service providers, and integrators. This is the version "1.0" of Routr console. ',n.a.createElement("br",null),'"Next-generation SIP Server"')))))}}var ca=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)({appBar:{position:"relative"},flex:{flex:1}})(Object(l.c)(la))));class ia extends n.a.Component{render(){const e=this.props,t=e.classes,a=e.appStore,r=e.apiStore,s=pt(a.getCurrentSection()),o=r.getResources();return n.a.createElement("div",{className:t.root},n.a.createElement(i.a,{position:"absolute",className:t.appBar},n.a.createElement(E,null)),n.a.createElement(c.a,{variant:"permanent",classes:{paper:t.drawerPaper}},n.a.createElement("div",{className:t.toolbar}),n.a.createElement(_,null)),n.a.createElement("main",{className:t.content,style:{backgroundColor:"settings"===a.getCurrentSection()?"#fff":""}},n.a.createElement("div",{className:t.toolbar}),a.isResourceSection()&&n.a.createElement(bt,null),a.isLocOrRegSection()&&n.a.createElement(na,{name:Ie(a.getCurrentSection()),columnData:s,data:o}),a.isSettingsSection()&&n.a.createElement($t,null),n.a.createElement(Zt,null),n.a.createElement(ca,null)))}}var da=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)(e=>({root:{flexGrow:1,zIndex:1,overflow:"hidden",position:"relative",display:"flex",height:"100vh"},appBar:{zIndex:e.zIndex.drawer+1},drawerPaper:{position:"relative",width:240},content:{overflow:"scroll",flexGrow:1,backgroundColor:e.palette.background.default,padding:e.spacing(3),minWidth:0},toolbar:e.mixins.toolbar}))(Object(l.c)(ia))));const ua=Object(Mt.a)({typography:{useNextVariants:!0},palette:{primary:{light:"#757ce8",main:"#33383d",dark:"#002884",contrastText:"#fff"},secondary:{main:"#3F51B5"}}});class ma extends r.Component{componentDidMount(){Ue("token")&&this.props.apiStore.setToken(Ue("token")),Ue("apiURL")&&this.props.apiStore.setApiURL(Ue("apiURL"))}render(){return n.a.createElement("div",{className:"App"},n.a.createElement(Bt.a,{theme:ua},n.a.createElement(da,null)))}}var pa=Object(l.b)("apiStore")(Object(l.c)(ma));const ha=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ga(e){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const t=e.installing;t.onstatechange=()=>{"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(e=>{console.error("Error during service worker registration:",e)})}var Sa=a(8);class ba{constructor(){this.currentResource={},this.resourceEditorOpen=!1,this.aboutDialogOpen=!1,this.fileUploaderOpen=!1,this.notificationOpen=!1,this.notificationMsg="",this.currentSection="domains",this.notify=(e,t)=>{this.notificationMsg=e,this.setNotificationOpen()},this.setNotificationOpen=()=>this.notificationOpen=!this.notificationOpen,this.setCurrentResource=e=>this.currentResource=e,this.setResourceEditorOpen=()=>this.resourceEditorOpen=!this.resourceEditorOpen,this.setAboutDialogOpen=()=>this.aboutDialogOpen=!this.aboutDialogOpen,this.setFileUploaderOpen=()=>this.fileUploaderOpen=!this.fileUploaderOpen,this.setCurrentSection=e=>this.currentSection=e,this.getCurrentSection=()=>this.currentSection,this.getCurrentResource=()=>this.currentResource,this.isResourceSection=()=>"domains"===this.currentSection||"agents"===this.currentSection||"peers"===this.currentSection||"gateways"===this.currentSection||"numbers"===this.currentSection,this.isLocOrRegSection=()=>"location"===this.currentSection||"registration"===this.currentSection,this.isSettingsSection=()=>"settings"===this.currentSection,this.isAboutDialogOpen=()=>this.aboutDialogOpen,this.isResourceEditorOpen=()=>this.resourceEditorOpen,this.isFileUploaderOpen=()=>this.fileUploaderOpen,this.isNotificationOpen=()=>this.notificationOpen}}Object(Sa.i)(ba,{currentResource:Sa.n,currentSection:Sa.n,resourceEditorOpen:Sa.n,aboutDialogOpen:Sa.n,fileUploaderOpen:Sa.n,notificationMsg:Sa.n,notificationOpen:Sa.n});const Ea=new ba;var va=a(32),fa=a.n(va),ya=a(60);class Ca{constructor(){var e=this;this.resources=[],this.apiURL="/api/v1beta1",this.config={spec:{restService:{},securityContext:{}}},this.token="",this.update=e=>{if(this.doesNotSupportWOOps())return void Ea.notify("Operation not supported by data source provider.");let t;try{t=JSON.parse(e)}catch(n){return void Ea.notify("Malformed document.")}const a=Ea.getCurrentSection(),r=Me(this.apiURL,a+"/"+t.metadata.ref,"",this.token);fetch(r,{method:"PUT",body:e}).then(e=>e.json()).then(e=>{200===e.status?Ea.notify("Updated resource."):422===e.status&&e.data?Ea.notify(e.message+": "+e.data):Ea.notify(e.message),this.loadResources(Ea.getCurrentSection())})},this.delete=function(){var t=Object(ya.a)(fa.a.mark((function t(a,r){var n,s,o,l,c;return fa.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.doesNotSupportWOOps()){t.next=3;break}return Ea.notify("Operation not supported by data source provider."),t.abrupt("return");case 3:n=t=>Me(e.apiURL,a+"/"+t,"",e.token),s=[],o=0;case 6:if(!(o<r.length)){t.next=22;break}return t.next=9,fetch(n(r[o]),{method:"DELETE"});case 9:return l=t.sent,t.next=12,l.json();case 12:if(405!==(c=t.sent).status&&409!==c.status){t.next=18;break}return Ea.notify(c.message),t.abrupt("return");case 18:200!==c.status&&s.push(c.message);case 19:o++,t.next=6;break;case 22:e.loadResources(Ea.getCurrentSection()),s.length>0?Ea.notify("An error occurred while deleting the resources."):Ea.notify("".concat(r.length," ").concat(Ea.getCurrentSection()," removed."));case 24:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),this.loadResources=function(){var t=Object(ya.a)(fa.a.mark((function t(a){var r,n,s,o,l;return fa.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="registration"===a?"registry":a,n=Me(e.apiURL,r,"*",e.token),t.next=4,fetch(n);case 4:return s=t.sent,t.next=7,s.json();case 7:200===(o=t.sent).status?(l=[],o&&o.data&&o.data.forEach(e=>{l.push(ht(e,a))}),e.resources=l):Ea.notify(o.message);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.getResources=()=>this.resources,this.getAPIUrl=()=>this.apiURL,this.setApiURL=e=>this.apiURL=e,this.getToken=()=>this.token,this.setToken=e=>this.token=e,this.saveConfig=e=>{if(this.doesNotSupportWOOps())return void Ea.notify("Operation not supported by data source provider.");const t=Me(this.apiURL,"system/config","",this.token);fetch(t,{method:"PUT",body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{if(200===e.status)Ea.notify("Updated settings. This changes will take effect on the next restart");else{let t=e.message;e.data&&(t+=": "+e.data),Ea.notify(t)}})},this.changeStatus=(e,t)=>{const a="system/status/".concat(e),r=Me(this.apiURL,a,"now=".concat(t),this.token);fetch(r,{method:"POST"}).then(e=>e.json()).then(e=>{if(200===e.status)Ea.notify("Restarting.");else{let t=e.message;e.data&&(t+=": "+e.data),Ea.notify(t)}})},this.loadConfig=Object(ya.a)(fa.a.mark((function t(){var a,r,n;return fa.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"system/config",a=Me(e.apiURL,"system/config","*",e.token),t.next=4,fetch(a);case 4:return r=t.sent,t.next=7,r.json();case 7:200===(n=t.sent).status?e.config=n.data:Ea.notify(n.message);case 9:case"end":return t.stop()}}),t)}))),this.getConfig=()=>this.config,this.doesNotSupportWOOps=()=>"files_data_provider"===this.config.spec.dataSource.provider,Object(Sa.s)(()=>""!==this.token||!0,Object(ya.a)(fa.a.mark((function t(){return fa.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loadConfig(),t.next=3,setTimeout(()=>{},1500);case 3:"settings"!==Ea.getCurrentSection()&&e.loadResources(Ea.getCurrentSection());case 4:case"end":return t.stop()}}),t)}))))}}Object(Sa.i)(Ca,{resources:Sa.n,token:Sa.n,config:Sa.n});const Pa=new Ca,wa={appStore:Ea,apiStore:Pa};o.a.render(n.a.createElement(l.a,wa,n.a.createElement(pa,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",()=>{const e="".concat("","/service-worker.js");ha?(!function(e){fetch(e).then(t=>{404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):ga(e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):ga(e)})}}()}},[[148,1,2]]]);
//# sourceMappingURL=main.36b5c6eb.chunk.js.map