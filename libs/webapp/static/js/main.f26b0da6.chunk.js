(this["webpackJsonproutr-ui"]=this["webpackJsonproutr-ui"]||[]).push([[0],{237:function(e,t,a){e.exports=a(761)},242:function(e,t,a){},243:function(e,t,a){},761:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(12),o=a.n(s),l=a(7),i=(a(242),a(243),a(244),a(838)),c=a(797),d=a(801),u=a(802),m=a(187),p=a.n(m),h=a(803),g=a(213),S=a(4);class b extends n.a.Component{constructor(...e){super(...e),this.state={auth:!0,anchorEl:null},this.handleChange=(e,t)=>{this.setState({auth:t})},this.handleMenu=e=>{this.setState({anchorEl:e.currentTarget})},this.handleClose=()=>{this.setState({anchorEl:null})}}render(){const e=this.props,t=e.classes,a=e.appStore,r=this.state,s=r.auth,o=r.anchorEl,l=Boolean(o);return n.a.createElement("div",null,n.a.createElement(c.a,{position:"static",color:"primary"},n.a.createElement(d.a,null,n.a.createElement("img",{src:"/images/logo.png",className:"App-logo",alt:"logo"}),n.a.createElement("span",{className:t.flex}),s&&n.a.createElement("div",null,n.a.createElement(u.a,{"aria-owns":l?"menu-appbar":null,"aria-haspopup":"true",onClick:this.handleMenu,color:"inherit"},n.a.createElement(p.a,null)),n.a.createElement(g.a,{id:"menu-appbar",anchorEl:o,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:l,onClose:this.handleClose},n.a.createElement(h.a,{onClick:()=>{a.setCurrentSection("settings"),this.handleClose()}},"Settings"),n.a.createElement(h.a,{onClick:()=>{a.setAboutDialogOpen(),this.handleClose()}},"About"))))))}}var E=Object(l.b)("appStore")(Object(S.a)({root:{flexGrow:1},flex:{flex:1},menuButton:{marginLeft:-12,marginRight:20},githubButton:{bordeR:0,color:"red"}})(Object(l.c)(b))),v=a(806),f=a(764),y=a(804),C=a(805),P=a(188),w=a.n(P),k=a(111),O=a.n(k),x=a(191),T=a.n(x),N=a(189),R=a.n(N),A=a(112),L=a.n(A),j=a(192),z=a.n(j),D=a(190),B=a.n(D),I=a(193),U=a.n(I),M=a(194),F=a.n(M),K=a(195),_=a.n(K);class W extends n.a.Component{render(){const e=this.props,t=e.classes,a=e.apiStore,r=e.appStore,s=(e,t)=>{r.setCurrentSection(t),r.isResourceSection()||r.isLocOrRegSection()?a.loadResources(t):r.isSettingsSection()&&a.loadConfig()};return n.a.createElement("div",{className:t.root},n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"domains")},n.a.createElement(y.a,null,n.a.createElement(w.a,null)),n.a.createElement(C.a,{primary:"Domains"})),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"agents")},n.a.createElement(y.a,null,n.a.createElement(R.a,null)),n.a.createElement(C.a,{primary:"Agents"})),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"peers")},n.a.createElement(y.a,null,n.a.createElement(B.a,null)),n.a.createElement(C.a,{primary:"Peers"})),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"gateways")},n.a.createElement(y.a,null,n.a.createElement(T.a,null)),n.a.createElement(C.a,{primary:"Gateways"})),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"numbers")},n.a.createElement(y.a,null,n.a.createElement(z.a,null)),n.a.createElement(C.a,{primary:"Numbers"})),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"location")},n.a.createElement(y.a,null,n.a.createElement(U.a,null)),n.a.createElement(C.a,{primary:"Location"})),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"registration")},n.a.createElement(y.a,null,n.a.createElement(F.a,null)),n.a.createElement(C.a,{primary:"Registration"})),n.a.createElement(v.a,null),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"settings")},n.a.createElement(y.a,null,n.a.createElement(O.a,null)),n.a.createElement(C.a,{primary:"Settings"})),n.a.createElement(f.a,{button:!0,onClick:e=>s(0,"logs")},n.a.createElement(y.a,null,n.a.createElement(L.a,null)),n.a.createElement(C.a,{primary:"Logs"})),n.a.createElement(f.a,{button:!0,onClick:e=>window.open("https://github.com/fonoster/routr/issues","_blank")},n.a.createElement(y.a,null,n.a.createElement(_.a,null)),n.a.createElement(C.a,{primary:"Help"})))}}var H=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)(e=>({root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper}}))(Object(l.c)(W)))),J=a(2),G=a(811),q=a(812),Y=a(809),$=a(807),V=a(840),X=a(808),Z=a(841),Q=a(58),ee=a(148),te=a(832),ae=a(810),re=a(197),ne=a.n(re),se=a(198),oe=a.n(se),le=a(114);function ie(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0}class ce extends n.a.Component{constructor(...e){super(...e),this.createSortHandler=e=>t=>{this.props.onRequestSort(t,e)}}render(){const e=this.props,t=e.onSelectAllClick,a=e.order,r=e.orderBy,s=e.numSelected,o=e.rowCount,l=e.columnData;return n.a.createElement($.a,null,n.a.createElement(X.a,null,n.a.createElement(Y.a,{padding:"checkbox"},n.a.createElement(te.a,{indeterminate:s>0&&s<o,checked:s===o,onChange:t})),l.map(e=>n.a.createElement(Y.a,{key:e.id,padding:e.disablePadding?"none":"default",sortDirection:r===e.pos&&a},n.a.createElement(ae.a,{title:"Sort",placement:e.numeric?"bottom-end":"bottom-start",enterDelay:300},n.a.createElement(Z.a,{active:r===e.pos,direction:a,onClick:this.createSortHandler(e.pos)},e.label))),this)))}}let de=e=>{const t=e.numSelected,a=e.classes,r=e.name,s=e.handleDeleteItems;return n.a.createElement(d.a,{className:Object(J.a)(a.root,{[a.highlight]:t>0})},n.a.createElement("div",{className:a.title},t>0?n.a.createElement(Q.a,{color:"inherit",variant:"subtitle1"},t," selected"):n.a.createElement(Q.a,{variant:"h6",id:"tableTitle"},r)),n.a.createElement("div",{className:a.spacer}),n.a.createElement("div",{className:a.actions},t>0?n.a.createElement(ae.a,{title:"Delete"},n.a.createElement(u.a,{"aria-label":"Delete",onClick:s},n.a.createElement(ne.a,null))):n.a.createElement(ae.a,{title:"Add"},n.a.createElement(u.a,{"aria-label":"Add",onClick:e.appStore.setFileUploaderOpen},n.a.createElement(oe.a,null)))))};de=Object(l.b)("appStore")(Object(S.a)(e=>({root:{paddingRight:e.spacing(1)},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(le.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}))(Object(l.c)(de)));class ue extends n.a.Component{constructor(e,t){super(e,t),this.handleRequestSort=(e,t)=>{const a=t;let r="desc";this.state.orderBy===t&&"desc"===this.state.order&&(r="asc"),this.setState({order:r,orderBy:a})},this.handleSelectAllClick=(e,t)=>{t?this.setState({selected:this.state.data.map(e=>e.c1)}):this.setState({selected:[]})},this.handleClick=(e,t)=>{const a=this.state.selected,r=a.indexOf(t);let n=[];-1===r?n=n.concat(a,t):0===r?n=n.concat(a.slice(1)):r===a.length-1?n=n.concat(a.slice(0,-1)):r>0&&(n=n.concat(a.slice(0,r),a.slice(r+1))),this.setState({selected:n})},this.handleChangePage=(e,t)=>this.setState({page:t}),this.handleChangeRowsPerPage=e=>this.setState({rowsPerPage:e.target.value}),this.isSelected=e=>-1!==this.state.selected.indexOf(e),this.showResourceEditor=e=>{this.props.appStore.setCurrentResource(e),this.props.appStore.setResourceEditorOpen()},this.handleDeleteItems=e=>this.props.apiStore.delete(this.props.appStore.getCurrentSection(),e),this.state={order:"asc",orderBy:"",selected:[],data:e.data,page:0,rowsPerPage:5}}static getDerivedStateFromProps(e,t){return e.data!==t.data?{data:e.data,selected:[]}:null}render(){const e=this.props,t=e.classes,a=e.columnData,r=e.name,s=e.data,o=this.state,l=o.order,i=o.orderBy,c=o.selected,d=o.rowsPerPage,u=o.page,m=d-Math.min(d,s.length-u*d);return n.a.createElement(ee.a,{className:t.root},n.a.createElement(de,{name:r,numSelected:c.length,handleDeleteItems:e=>{this.handleDeleteItems(c),this.setState({selected:[]})}}),n.a.createElement("div",{className:t.tableWrapper},n.a.createElement(G.a,{className:t.table,"aria-labelledby":"tableTitle"},n.a.createElement(ce,{columnData:a,numSelected:c.length,order:l,orderBy:i,onSelectAllClick:this.handleSelectAllClick,onRequestSort:this.handleRequestSort,rowCount:s.length}),n.a.createElement(q.a,null,function(e,t){const a=e.map((e,t)=>[e,t]);return a.sort((e,a)=>{const r=t(e[0],a[0]);return 0!==r?r:e[1]-a[1]}),a.map(e=>e[0])}(s,function(e,t){return"desc"===e?(e,a)=>ie(e,a,t):(e,a)=>-ie(e,a,t)}(l,i)).slice(u*d,u*d+d).map(e=>{const a=this.isSelected(e.c1);return n.a.createElement(X.a,{hover:!0,role:"checkbox","aria-checked":a,tabIndex:-1,key:e.c1,selected:a},n.a.createElement(Y.a,{padding:"checkbox",onClick:t=>this.handleClick(t,e.c1)},n.a.createElement(te.a,{checked:a})),n.a.createElement(Y.a,{onClick:t=>this.showResourceEditor(e.c2),className:t.cursor,component:"th",scope:"row",padding:"none"},e.c3),n.a.createElement(Y.a,{onClick:t=>this.showResourceEditor(e.c2),className:t.cursor},e.c4),e.c5&&n.a.createElement(Y.a,{onClick:t=>this.showResourceEditor(e.c2),className:t.cursor},e.c5),e.c6&&n.a.createElement(Y.a,{onClick:t=>this.showResourceEditor(e.c2),className:t.cursor},e.c6),e.c7&&n.a.createElement(Y.a,{onClick:t=>this.showResourceEditor(e.c2),className:t.cursor},e.c7),n.a.createElement(Y.a,{onClick:t=>this.showResourceEditor(e.c2),className:t.cursor},e.c1))}),m>0&&n.a.createElement(X.a,{style:{height:49*m}},n.a.createElement(Y.a,{colSpan:6}))))),n.a.createElement(V.a,{rowsPerPageOptions:[5,10,25],component:"div",count:s.length,rowsPerPage:d,page:u,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}var me=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)(e=>({root:{width:"100%",marginTop:e.spacing(3)},table:{minWidth:1020},tableWrapper:{overflowX:"auto"},cursor:{cursor:"pointer"}}))(Object(l.c)(ue)))),pe=a(142),he=a.n(pe),ge=(a(255),a(657),a(658),a(659),a(818)),Se=a(57),be=a.n(Se),Ee=a(830),ve=a(819),fe=a(143),ye=a.n(fe),Ce=a(144),Pe=a.n(Ce),we=a(767),ke=a(815),Oe=a(816),xe=a(817);const Te=Object(S.a)(e=>({root:{borderBottom:"1px solid ".concat(e.palette.divider),margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}))(e=>{const t=e.children,a=e.classes,r=e.onClose;return n.a.createElement(ke.a,{disableTypography:!0,className:a.root},n.a.createElement(Q.a,{variant:"h6"},t),r?n.a.createElement(u.a,{"aria-label":"Close",className:a.closeButton,onClick:r},n.a.createElement(be.a,null)):null)}),Ne=Object(S.a)(e=>({root:{margin:0,padding:0}}))(Oe.a),Re=Object(S.a)(e=>({root:{borderTop:"1px solid ".concat(e.palette.divider),margin:0,padding:e.spacing(1)}}))(xe.a);class Ae extends n.a.Component{constructor(e){super(e),this.handleTabsChange=(e,t)=>{if(this.setState({tab:t}),0===t)this.setState({resourceYaml:ye.a.stringify(JSON.parse(this.state.resourceJson))});else{const e=JSON.stringify(Pe.a.parse(this.state.resourceYaml),null,"\t");this.setState({resourceJson:e})}},this.handleChangeJson=e=>{this.setState({resourceJson:e}),this.setState({jsonEditorAnnotations:this.refs.jsonEditor.editor.getSession().getAnnotations()})},this.handleChangeYaml=e=>{this.setState({resourceYaml:e}),this.setState({yamlEditorAnnotations:this.refs.yamlEditor.editor.getSession().getAnnotations()})},this.saveResource=()=>{try{const e=1===this.state.tab?this.state.resourceJson:JSON.stringify(Pe.a.parse(this.state.resourceYaml));this.props.apiStore.update(e),this.props.appStore.setResourceEditorOpen(),this.setState({resource:void 0})}catch(e){this.props.appStore.notify("Malformed document.")}},this.state={tab:0}}UNSAFE_componentWillUpdate(){const e=JSON.parse(this.props.appStore.getCurrentResource());if(!this.state.resource||this.state.resource.metadata.ref!==e.metadata.ref){const t=JSON.stringify(e,null,"\t"),a=ye.a.stringify(e);this.setState({resource:e,resourceJson:t,resourceYaml:a})}}render(){const e=this.state.tab;return n.a.createElement("div",null,n.a.createElement(ge.a,{"aria-labelledby":"customized-dialog-title",onClose:this.props.appStore.setResourceEditorOpen,open:this.props.appStore.isResourceEditorOpen()},n.a.createElement(Te,{id:"customized-dialog-title",onClose:this.props.appStore.setResourceEditorOpen},"Edit a resource"),n.a.createElement(Ee.a,{onChange:this.handleTabsChange,value:e},n.a.createElement(ve.a,{label:"YAML"}),n.a.createElement(ve.a,{label:"JSON"})),n.a.createElement(Ne,null,0===e&&n.a.createElement(he.a,{ref:"yamlEditor",mode:"yaml",theme:"textmate",showGutter:!0,value:this.state.resourceYaml,onChange:this.handleChangeYaml,editorProps:{$blockScrolling:!0}}),1===e&&n.a.createElement(he.a,{ref:"jsonEditor",mode:"json",theme:"textmate",showGutter:!0,value:this.state.resourceJson,onChange:this.handleChangeJson,editorProps:{$blockScrolling:!1}})),n.a.createElement(Re,null,n.a.createElement(we.a,{size:"small",variant:"contained",disableElevation:!0,color:"secondary",onClick:this.saveResource},"Save"),n.a.createElement(we.a,{size:"small",variant:"contained",disableElevation:!0,onClick:this.props.appStore.setResourceEditorOpen},"Cancel"))))}}var Le=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)({appBar:{position:"relative"},flex:{flex:1}})(Object(l.c)(Ae)))),je=a(199),ze=a.n(je),De=a(145),Be=a(200),Ie=a.n(Be);function Ue(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))}function Me(e,t){t||(t=window.location.href),e=e.replace(/[[]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}function Fe(e,t,a,r){let n="".concat(e,"/").concat(t);return a&&(n="".concat(n,"?filter=").concat(a)),r&&(n=a?"".concat(n,"&token=").concat(r):"".concat(n,"?token=").concat(r)),n}const Ke=e=>e&&e.length>0,_e=e=>!Ke(e)||De.ipv4.isValid(e),We=e=>!Ke(e)||!isNaN(e),He=e=>!Ke(e)||Ie()(e),Je=e=>!Ke(e)||!isNaN(e),Ge=e=>!Ke(e)||!isNaN(e),qe=e=>{if(!Ke(e))return!0;const t=e.toString().split("\n");return t.filter(e=>De.ipv4.isSubnet(e)).length===t.length},Ye=e=>{if(!Ke(e))return!0;return 0===e.split(",").filter(e=>1===e.split("=").length||0===e.split("=")[1].length||!isNaN(e.split("=")[0])).length},$e=Object(S.a)(e=>({root:{borderBottom:"1px solid ".concat(e.palette.divider),margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}))(e=>{const t=e.children,a=e.classes,r=e.onClose;return n.a.createElement(ke.a,{disableTypography:!0,className:a.root},n.a.createElement(Q.a,{variant:"h6"},t),r?n.a.createElement(u.a,{"aria-label":"Close",className:a.closeButton,onClick:r},n.a.createElement(be.a,null)):null)}),Ve=Object(S.a)(e=>({root:{margin:0,padding:0}}))(Oe.a);class Xe extends n.a.Component{constructor(...e){super(...e),this.state={oldCnt:0}}render(){const e=this.props,t=e.apiStore,a=e.appStore,r={success:e=>{t.loadResources(a.getCurrentSection()),a.setFileUploaderOpen(),a.notify("Resources added.")},sending:()=>this.setState({oldCnt:t.resources.length}),error:e=>{a.notify("An error occurred while adding resources.")}},s={iconFiletypes:[".yaml",".yml"],showFiletypeIcon:!0,postUrl:Fe(t.getApiURL(),a.getCurrentSection(),"",t.getToken())};return n.a.createElement("div",null,n.a.createElement(ge.a,{"aria-labelledby":"customized-dialog-title",open:this.props.appStore.isFileUploaderOpen(),onClose:this.props.appStore.setFileUploaderOpen},n.a.createElement($e,{id:"customized-dialog-title",onClose:this.props.appStore.setFileUploaderOpen},"Submit Resource File"),n.a.createElement(Ve,{style:{padding:10}},n.a.createElement(ze.a,{eventHandlers:r,djsConfig:{addRemoveLinks:!0},config:s}))))}}var Ze=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)({appBar:{position:"relative"},flex:{flex:1}})(Object(l.c)(Xe)))),Qe=a(201),et=a.n(Qe),tt=a(820),at=a(822),rt=a(821);var nt=Object(l.b)("appStore")(Object(S.a)(e=>({button:{margin:e.spacing(1)},input:{display:"none"},card:{maxWidth:300,position:"relative",margin:"10% auto",padding:8},title:{marginBottom:16,fontSize:14},pos:{marginBottom:12}}))(Object(l.c)((function(e){const t=e.classes,a=e.resource;return n.a.createElement("div",null,n.a.createElement(tt.a,{justify:"center",className:t.card},n.a.createElement(rt.a,null,n.a.createElement(Q.a,{className:t.title,color:"textSecondary"},"No resources found"),n.a.createElement(Q.a,{component:"h2"},a),n.a.createElement(Q.a,{className:t.pos,color:"textSecondary"},"resource"),n.a.createElement(Q.a,{className:t.secondaryHeading},"At this time not resources found on the ",a.toLowerCase()," section. Go to the documentation to learn more about resources ",n.a.createElement("a",{href:"https://routr.io/docs"},n.a.createElement(et.a,{style:{color:"#3F51B5",fontSize:18}})))),n.a.createElement(at.a,null,n.a.createElement(we.a,{className:t.button,variant:"contained",onClick:e.appStore.setFileUploaderOpen,color:"secondary",size:"small",disableElevation:!0},"Add ",a))))})))),st=a(76),ot=a.n(st);const lt=[{id:"name",numeric:!1,disablePadding:!0,label:"Domain Name",pos:"c1"},{id:"uri",numeric:!1,disablePadding:!1,label:"URI",pos:"c2"},{id:"modified",numeric:!1,disablePadding:!1,label:"Modified",pos:"c3"},{id:"ref",numeric:!1,disablePadding:!1,label:"Ref",pos:"c4"}];function it(e){return{c1:e.metadata.ref,c2:JSON.stringify(e),c3:e.metadata.name,c4:e.spec.context.domainUri,c5:ot()(e.metadata.modifiedOn).fromNow()}}const ct=[{id:"name",numeric:!1,disablePadding:!0,label:"Agent Name",pos:"c1"},{id:"username",numeric:!1,disablePadding:!1,label:"Username",pos:"c2"},{id:"modified",numeric:!1,disablePadding:!1,label:"Modified",pos:"c3"},{id:"ref",numeric:!1,disablePadding:!1,label:"Ref",pos:"c4"}];const dt=[{id:"name",numeric:!1,disablePadding:!0,label:"Peer Name",pos:"c1"},{id:"username",numeric:!1,disablePadding:!1,label:"Username",pos:"c2"},{id:"modified",numeric:!1,disablePadding:!1,label:"Modified",pos:"c3"},{id:"ref",numeric:!1,disablePadding:!1,label:"Ref",pos:"c4"}];const ut=[{id:"name",numeric:!1,disablePadding:!0,label:"Gateway",pos:"c1"},{id:"username",numeric:!1,disablePadding:!1,label:"Username",pos:"c2"},{id:"host",numeric:!1,disablePadding:!1,label:"Host",pos:"c3"},{id:"modified",numeric:!1,disablePadding:!1,label:"Modified",pos:"c4"},{id:"ref",numeric:!1,disablePadding:!1,label:"Ref",pos:"c5"}];const mt=[{id:"number",numeric:!1,disablePadding:!0,label:"Number",pos:"c1"},{id:"location",numeric:!1,disablePadding:!1,label:"Location",pos:"c2"},{id:"aorLink",numeric:!1,disablePadding:!1,label:"AOR Link",pos:"c3"},{id:"modified",numeric:!1,disablePadding:!1,label:"Modified",pos:"c4"},{id:"ref",numeric:!1,disablePadding:!1,label:"Ref",pos:"c5"}];const pt=[{id:"addressOfRecord",numeric:!1,disablePadding:!0,label:"Address Of Record",pos:"c1"},{id:"contactInfo",numeric:!1,disablePadding:!1,label:"Contact Information",pos:"c2"}];const ht=[{id:"host",numeric:!1,disablePadding:!1,label:"Host",pos:"c1"},{id:"username",numeric:!1,disablePadding:!0,label:"Username",pos:"c2"},{id:"ipAddress",numeric:!1,disablePadding:!1,label:"IP",pos:"c3"},{id:"registered",numeric:!1,disablePadding:!1,label:"Registered",pos:"c4"}];function gt(e){switch(e){case"domains":return lt;case"agents":return ct;case"peers":return dt;case"gateways":return ut;case"numbers":return mt;case"location":return pt;case"registration":return ht;default:return lt}}function St(e,t){switch(t){case"domains":return it(e);case"agents":case"peers":return function(e){return{c1:e.metadata.ref,c2:JSON.stringify(e),c3:e.metadata.name,c4:e.spec.credentials.username,c5:ot()(e.metadata.modifiedOn).fromNow()}}(e);case"gateways":return function(e){return{c1:e.metadata.ref,c2:JSON.stringify(e),c3:e.metadata.name,c4:e.spec.credentials&&e.spec.credentials.username?e.spec.credentials.username:"None",c5:e.spec.host,c6:ot()(e.metadata.modifiedOn).fromNow()}}(e);case"numbers":return function(e){let t="";return e.metadata.geoInfo&&(t=e.metadata.geoInfo.city+", "+e.metadata.geoInfo.country),{c1:e.metadata.ref,c2:JSON.stringify(e),c3:e.spec.location.telUrl,c4:t,c5:e.spec.location.aorLink,c6:ot()(e.metadata.modifiedOn).fromNow()}}(e);case"location":return function(e){return{c1:e.addressOfRecord,c2:e.contactInfo}}(e);case"registration":return function(e){return console.log("item:"+JSON.stringify(e)),{c1:e.user,c2:e.host,c3:e.ip,c4:e.regOnFormatted}}(e);default:return it(e)}}var bt=a(214);class Et extends n.a.Component{render(){const e=this.props,t=e.appStore,a=e.apiStore,r=()=>a.getResources().length>0,s=()=>Ue(t.getCurrentSection()),o=gt(t.getCurrentSection()),l=a.getResources();return n.a.createElement("div",null,r()&&n.a.createElement(bt.a,{in:!0},n.a.createElement(me,{hide:!0,name:s(),columnData:o,data:l})),!r()&&n.a.createElement(bt.a,{in:!0},n.a.createElement(nt,{resource:s(),handleAddItem:e=>this.setState({fileUploaderOpen:!0})})),n.a.createElement(Le,null),n.a.createElement(Ze,null))}}var vt=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(l.c)(Et))),ft=a(823);const yt=e=>({heading:{fontSize:e.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},textField:{marginBottom:10,width:320,marginRight:10},bcLink:{color:e.palette.primary.main,textDecoration:"none","&:hover":{textDecoration:"underline"},display:"flex"},link2:{color:e.palette.primary.main,textDecoration:"none","&:hover":{textDecoration:"underline"},display:"flex"},root:{marginBottom:e.spacing(2)},link:{display:"flex",marginTop:5},icon:{marginRight:e.spacing(.5),width:20,height:20}});var Ct=Object(S.a)(yt)((function(e){const t=e.onChangeSection,a=e.classes,r=(e,a)=>{e.preventDefault(),t(a)};return n.a.createElement("div",null,n.a.createElement(ft.a,{color:"secondary",href:"/",onClick:e=>r(e,"general"),className:a.link},"General"),n.a.createElement(ft.a,{color:"secondary",onClick:e=>r(e,"networking_and_transport"),href:"/",className:a.link},"Networking and Transport"),n.a.createElement(ft.a,{color:"secondary",onClick:e=>r(e,"nat"),href:"/",className:a.link},"NAT"),n.a.createElement(ft.a,{color:"secondary",onClick:e=>r(e,"access_control_lists"),href:"/",className:a.link},"Access Control Lists"),n.a.createElement(ft.a,{color:"secondary",onClick:e=>r(e,"data_access"),href:"/",className:a.link},"Data Access"),n.a.createElement(ft.a,{color:"secondary",onClick:e=>r(e,"rest_service"),href:"/",className:a.link},"Rest Service"),n.a.createElement(ft.a,{color:"secondary",onClick:e=>r(e,"certificates"),href:"/",className:a.link},"Certificates"),n.a.createElement(ft.a,{color:"secondary",onClick:e=>r(e,"danger_zone"),href:"/",className:a.link},"Danger Zone"))})),Pt=a(835);var wt=Object(S.a)(yt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(Q.a,{className:o.secondaryHeading},"Sets the SIP header User-Agent to the desired value. ",n.a.createElement("br",null)," If not value is provided, the server will use ",n.a.createElement("em",null,"`Routr $version.`")),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"userAgent",label:"User Agent",multiline:!0,rowsMax:"4",value:r.userAgent,onChange:s,className:o.textField,size:"small",variant:"outlined",placeholder:"Routr v1.0"}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(we.a,{onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(we.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))}));var kt=Object(S.a)(yt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(Q.a,{className:o.secondaryHeading},"This is the default IP address for the SIP stack. ",n.a.createElement("br",null),"All Sip traffic will be routed through this interface."),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"bindAddr",label:"Bind Address",value:r.bindAddr,onChange:s,className:o.textField,error:!_e(r.bindAddr),variant:"outlined",size:"small",placeholder:"192.168.1.12"}),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"udpPort",label:"UDP Port",onChange:s,className:o.textField,value:r.transportPorts.udp,error:!We(r.transportPorts.udp),variant:"outlined",size:"small",placeholder:"5060",inputProps:{maxLength:5}}),n.a.createElement("br",null),n.a.createElement(Q.a,{className:o.secondaryHeading},"You can use the same port number for both TCP",n.a.createElement("br",null)," and UDP."),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"tcpPort",label:"TCP Port",onChange:s,className:o.textField,value:r.transportPorts.tcp,error:!We(r.transportPorts.tcp),variant:"outlined",size:"small",placeholder:"5060",inputProps:{maxLength:5}}),n.a.createElement("br",null),n.a.createElement(Q.a,{className:o.secondaryHeading},"Secure transport, like TLS and WSS, required",n.a.createElement("br",null),"a valid certificate to secure the SIP signaling."),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"tlsPort",label:"TLS Port",onChange:s,className:o.textField,value:r.transportPorts.tls,error:!We(r.transportPorts.tls),variant:"outlined",size:"small",placeholder:"5061",inputProps:{maxLength:5}}),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"wsPort",label:"WS Port",onChange:s,className:o.textField,value:r.transportPorts.ws,error:!We(r.transportPorts.ws),variant:"outlined",size:"small",placeholder:"5062",inputProps:{maxLength:5}}),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"wssPort",label:"WSS Port",onChange:s,className:o.textField,value:r.transportPorts.wss,error:!We(r.transportPorts.wss),variant:"outlined",size:"small",placeholder:"5063",inputProps:{maxLength:5}}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(we.a,{disabled:!(_e(r.bindAddr)&&We(r.transportPorts.udp)&&We(r.transportPorts.tcp)&&We(r.transportPorts.tls)&&We(r.transportPorts.ws)&&We(r.transportPorts.wss)),onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(we.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))})),Ot=a(824),xt=a(839),Tt=a(831),Nt=a(825);var Rt=Object(S.a)(yt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(Q.a,{className:o.secondaryHeading},"The IP address to advertise. This must be used",n.a.createElement("br",null),"in combination with Localnets. If Localnets is",n.a.createElement("br",null)," empty, the External Address will be ignored."),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"externAddr",label:"External Address",value:r.externAddr,onChange:s,className:o.textField,error:!_e(r.externAddr),variant:"outlined",size:"small",placeholder:"172.220.246.46"}),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"localnets",label:"Localnets",multiline:!0,rowsMax:"4",rows:"3",value:r.localnets,onChange:s,error:!qe(r.localnets),className:o.textField,variant:"outlined",size:"small",placeholder:"192.168.1.149/32"}),n.a.createElement("br",null),n.a.createElement(Q.a,{className:o.secondaryHeading},"Choosing Internal causes the server to use the",n.a.createElement("br",null),' IP and port it "sees"(received & rport) from a ',n.a.createElement("br",null)," device attempting to register. You will rarely need",n.a.createElement("br",null)," to change this."),n.a.createElement("br",null),n.a.createElement(Ot.a,{size:"small",variant:"outlined",className:o.textField},n.a.createElement(xt.a,null,"Registration Interface"),n.a.createElement(Tt.a,{value:r.registrarIntf,onChange:s,labelWidth:155,size:"small"},n.a.createElement(h.a,{id:"registrarIntf",value:"Internal"},n.a.createElement("em",null,"Internal")),n.a.createElement(h.a,{id:"registrarIntf",value:"External"},"External"))),n.a.createElement("br",null),n.a.createElement(Nt.a,{control:n.a.createElement(te.a,{id:"recordRoute",onChange:s,checked:r.recordRoute,color:"primary",size:"small"}),label:"Record-Route"}),n.a.createElement("br",null),n.a.createElement(Q.a,{variant:"caption"},"Check if you want server to stay within the signaling path",n.a.createElement("br",null),n.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://routr.io/docs/configuration/general/",className:o.link2},"Learn more")),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(we.a,{disabled:!(_e(r.externAddr)&&qe(r.localnets)),onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(we.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))})),At=a(77),Lt=a(827),jt=a(202),zt=a.n(jt),Dt=a(828),Bt=a(762),It=a(765),Ut=a(834),Mt=a(829),Ft=a(212),Kt=a(826);const _t=["Restart Server Now","Restart Server","Stop Server Now","Stop Server"];var Wt=Object(S.a)(yt)((function(e){const t=n.a.useState(!1),a=Object(At.a)(t,2),r=a[0],s=a[1],o=n.a.useState(!1),l=Object(At.a)(o,2),i=l[0],c=l[1],d=n.a.useState(""),u=Object(At.a)(d,2),m=u[0],p=u[1],g=n.a.useState(""),S=Object(At.a)(g,2),b=S[0],E=S[1],v=n.a.useState(1),f=Object(At.a)(v,2),y=f[0],C=f[1],P=n.a.useRef(null),w=e.onRestartServerNow,k=e.onStopServerNow,O=e.onRestartServer,x=e.onStopServer,T=e.classes,N=()=>{c(!1)},R=e=>{P.current&&P.current.contains(e.target)||s(!1)},A=Object(Ft.a)({palette:{error:{main:"#fafafa"}}});return n.a.createElement("div",null,n.a.createElement(Q.a,{className:T.secondaryHeading},"Before restarting or stopping the server be sure to check your ",n.a.createElement("br",null),'configurations. If you chose an action with "NOW" it will drop all ',n.a.createElement("br",null),"active calls and inmediatly restart or stop the server."),n.a.createElement("br",null),n.a.createElement(Kt.a,{theme:A},n.a.createElement(Lt.a,{variant:"outlined",color:"secondary",ref:P,"aria-label":"split button"},n.a.createElement(we.a,{onClick:()=>{p(_t[y].toUpperCase()),c(!0)}},_t[y]),n.a.createElement(we.a,{color:"secondary",size:"small","aria-controls":r?"split-button-menu":void 0,"aria-expanded":r?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",onClick:()=>{s(e=>!e)}},n.a.createElement(zt.a,null)))),n.a.createElement(It.a,{open:r,anchorEl:P.current,role:void 0,transition:!0,disablePortal:!0},({TransitionProps:e,placement:t})=>n.a.createElement(Bt.a,Object.assign({},e,{style:{transformOrigin:"bottom"===t?"center top":"center bottom"}}),n.a.createElement(ee.a,null,n.a.createElement(Dt.a,{onClickAway:R},n.a.createElement(Ut.a,{id:"split-button-menu"},_t.map((e,t)=>n.a.createElement(h.a,{key:e,selected:t===y,onClick:e=>((e,t)=>{C(t),s(!1)})(0,t)},e))))))),n.a.createElement(ge.a,{open:i,onClose:N,"aria-labelledby":"form-dialog-title"},n.a.createElement(ke.a,{id:"form-dialog-title"},"Are you sure?"),n.a.createElement(Oe.a,null,n.a.createElement(Mt.a,{className:T.secondaryHeading},"Last chance. A signal will be send to your Routr instance and the UI will be temporarily unresponsive. Some changes can render your server inoperable. Proceed with caution!"),n.a.createElement(Pt.a,{autoFocus:!0,margin:"dense",id:"name",onChange:e=>E(e.target.value),label:"Please type ".concat(m," to continue"),type:"email",fullWidth:!0})),n.a.createElement(xe.a,null,n.a.createElement(we.a,{onClick:N,color:"primary"},"Cancel"),n.a.createElement(we.a,{disabled:!(m===b),onClick:()=>{switch(y){case 0:w();break;case 1:O();break;case 2:k();break;case 3:x()}c(!1)},color:"primary"},"Continue"))))}));var Ht=Object(S.a)(yt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(Q.a,{className:o.secondaryHeading},"The recommended provider for production is",n.a.createElement("br",null),n.a.createElement("em",null,"redis_data_provider.")),n.a.createElement("br",null),n.a.createElement(Ot.a,{size:"small",variant:"outlined",className:o.formControl},n.a.createElement(xt.a,null,"Data Source Provider"),n.a.createElement(Tt.a,{labelId:"demo-simple-select-outlined-label",value:r.dsProvider,onChange:s,labelWidth:155},n.a.createElement(h.a,{id:"dsProvider",value:"files_data_provider"},n.a.createElement("em",null,"Files Data Source")),n.a.createElement(h.a,{id:"dsProvider",value:"redis_data_provider"},"Redis Data Provider"))),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"dsParameters",label:"Data Source Parameters",value:r.dsParameters,onChange:s,className:o.textField,error:!Ye(r.dsParameters),variant:"outlined",size:"small",placeholder:"host=localhost,port=6379"}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(we.a,{disabled:!Ye(r.dsParameters),onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(we.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))}));var Jt=Object(S.a)(yt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(Q.a,{className:o.secondaryHeading},"This is the default IP address for the Rest service. ",n.a.createElement("br",null)," All HTTP traffic will be routed through this interface."),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"restBindAddr",label:"Bind Address",value:r.restBindAddr,onChange:s,className:o.textField,error:!_e(r.restBindAddr),variant:"outlined",size:"small",placeholder:"0.0.0.0"}),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"restPort",label:"HTTP Port",onChange:s,className:o.textField,value:r.restPort,error:!We(r.restPort),variant:"outlined",size:"small",placeholder:"4567"}),n.a.createElement("br",null),n.a.createElement(Q.a,{className:o.secondaryHeading},"Minimum thread allocation. Defaults to 8."),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"restMinThreads",label:"Minimum Threads",onChange:s,className:o.textField,value:r.restMinThreads,variant:"outlined",size:"small",error:!Ge(r.restMinThreads),placeholder:"8"}),n.a.createElement("br",null),n.a.createElement(Q.a,{className:o.secondaryHeading},"Maximum thread allocation. Defaults to 200."),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"restMaxThreads",label:"Maximum Threads",onChange:s,className:o.textField,value:r.restMaxThreads,error:!Ge(r.restMaxThreads),variant:"outlined",size:"small",placeholder:"200"}),n.a.createElement("br",null),n.a.createElement(Q.a,{className:o.secondaryHeading},"Will reject requests that last more than the timeout. ",n.a.createElement("br",null),"Defaults to 5000(5 seconds.)"),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"restTimeOutMillis",label:"Request Timeout",onChange:s,className:o.textField,value:r.restTimeOutMillis,error:!Je(r.restTimeOutMillis),variant:"outlined",size:"small",placeholder:"5000"}),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"restKeyStorePath",label:"KeyStore Path",onChange:s,className:o.textField,value:r.restKeyStorePath,variant:"outlined",size:"small",placeholder:"/etc/certificates/api-cert.jks"}),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"restTrustStorePath",label:"TrustStore Path",onChange:s,className:o.textField,value:r.restTrustStorePath,variant:"outlined",size:"small",placeholder:"/etc/certificates/api-cert.jks"}),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"restKeyStorePassword",label:"KeyStore Password",onChange:s,className:o.textField,value:r.restKeyStorePassword,variant:"outlined",type:"password",size:"small"}),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"restTrustStorePassword",label:"TrustStore Password",onChange:s,className:o.textField,value:r.restTrustStorePassword,variant:"outlined",type:"password",size:"small"}),n.a.createElement("br",null),n.a.createElement(Nt.a,{control:n.a.createElement(te.a,{id:"restUnsecured",onChange:s,checked:r.restUnsecured,color:"primary",size:"small"}),label:"Allow Unsecured"}),n.a.createElement("br",null),n.a.createElement(Q.a,{variant:"caption"},"Check if you want to enable unsecured connections with",n.a.createElement("br",null),"the APIs. Not recommended in production.",n.a.createElement("br",null),n.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://routr.io/docs/configuration/general/",className:o.link2},"Learn more")),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(we.a,{disabled:!(_e(r.restBindAddr)&&We(r.restPort)&&Ge(r.restMinThreads)&&Ge(r.restMaxThreads)&&He(r.restKeyStorePath)&&He(r.restTrustStorePath)&&Je(r.restTimeOutMillis)),onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(we.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))}));var Gt=Object(S.a)(yt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(Q.a,{className:o.secondaryHeading},"This configurations affect all your domains."),n.a.createElement("br",null),n.a.createElement(Ot.a,{size:"small",variant:"outlined",className:o.textField},n.a.createElement(xt.a,null,"Client Authentication Type"),n.a.createElement(Tt.a,{value:r.scClientAuthType,onChange:s,labelWidth:190,size:"small"},n.a.createElement(h.a,{id:"scClientAuthType",value:"DisabledAll"},n.a.createElement("em",null,"DisabledAll")),n.a.createElement(h.a,{id:"scClientAuthType",value:"Disabled"},"Disabled"),n.a.createElement(h.a,{id:"scClientAuthType",value:"Enabled"},"Enabled"),n.a.createElement(h.a,{id:"scClientAuthType",value:"Want"},"Want"))),n.a.createElement("br",null),n.a.createElement(Ot.a,{size:"small",variant:"outlined",className:o.textField},n.a.createElement(xt.a,null,"KeyStore Type"),n.a.createElement(Tt.a,{value:r.scKeyStoreType,onChange:s,labelWidth:108,size:"small"},n.a.createElement(h.a,{id:"scKeyStoreType",value:"jks"},n.a.createElement("em",null,"JKS")),n.a.createElement(h.a,{id:"scKeyStoreType",value:"pkcs12"},"PKCS12"))),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"scKeyStorePath",label:"KeyStore Path",onChange:s,className:o.textField,value:r.scKeyStorePath,error:!He(r.scKeyStorePath),variant:"outlined",size:"small",placeholder:"/etc/certificates/domain-cert.jks"}),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"scTrustStorePath",label:"TrustStore Path",onChange:s,className:o.textField,value:r.scTrustStorePath,error:!He(r.scTrustStorePath),variant:"outlined",size:"small",placeholder:"/etc/certificates/domain-cert.jks"}),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"scKeyStorePassword",label:"KeyStore Password",onChange:s,className:o.textField,value:r.scKeyStorePassword,variant:"outlined",type:"password",size:"small"}),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"scTrustStorePassword",label:"TrustStore Password",onChange:s,className:o.textField,value:r.scTrustStorePassword,variant:"outlined",type:"password",size:"small"}),n.a.createElement("br",null),n.a.createElement(Q.a,{className:o.secondaryHeading},"TLS Support"),n.a.createElement(Nt.a,{style:{marginLeft:10},control:n.a.createElement(te.a,{id:"scSSLv3",onChange:s,checked:r.scSSLv3,color:"primary",size:"small"}),label:"SSLv3"}),n.a.createElement("br",null),n.a.createElement(Nt.a,{style:{marginLeft:10},control:n.a.createElement(te.a,{id:"scTLSv1",onChange:s,checked:r.scTLSv1,color:"primary",size:"small"}),label:"TLSv1"}),n.a.createElement("br",null),n.a.createElement(Nt.a,{style:{marginLeft:10},control:n.a.createElement(te.a,{id:"scTLSv11",onChange:s,checked:r.scTLSv11,color:"primary",size:"small"}),label:"TLSv1.1"}),n.a.createElement("br",null),n.a.createElement(Nt.a,{style:{marginLeft:10},control:n.a.createElement(te.a,{id:"scTLSv12",onChange:s,checked:r.scTLSv12,color:"primary",size:"small"}),label:"TLSv1.2"}),n.a.createElement("br",null),n.a.createElement(Nt.a,{control:n.a.createElement(te.a,{id:"scDebugging",onChange:s,checked:r.scDebugging,color:"primary",size:"small"}),label:"Enable Debugging"}),n.a.createElement("br",null),n.a.createElement(Q.a,{variant:"caption"},"Check if you want to enable debugging for secured",n.a.createElement("br",null),"connections. Not recommended in production.",n.a.createElement("br",null),n.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://routr.io/docs/configuration/general/",className:o.link2},"Learn more")),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(we.a,{disabled:!(He(r.scKeyStorePath)&&He(r.scTrustStorePath)),onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(we.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))}));var qt=Object(S.a)(yt)((function(e){const t=e.onSave,a=e.onCancel,r=e.config,s=e.onChange,o=e.classes;return n.a.createElement("div",null,n.a.createElement(Q.a,{className:o.secondaryHeading},"Denies or allows incoming traffic from the network list. ",n.a.createElement("br",null),'The "Deny Subnets" takes precedence over the ',n.a.createElement("br",null),' "Allow Subnets."'),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"aclDeny",label:"Deny Subnets",multiline:!0,rowsMax:"4",rows:"3",value:r.aclDeny,onChange:s,error:!qe(r.aclDeny),className:o.textField,variant:"outlined",size:"small",placeholder:"0.0.0.0/1"}),n.a.createElement("br",null),n.a.createElement(Pt.a,{id:"aclAllow",label:"Allow Subnets",multiline:!0,rowsMax:"4",rows:"3",value:r.aclAllow,onChange:s,error:!qe(r.aclAllow),className:o.textField,variant:"outlined",size:"small",placeholder:"192.168.1.12/32"}),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",null,n.a.createElement(we.a,{disabled:!(qe(r.aclDeny)&&qe(r.aclAllow)),onClick:t,size:"small",variant:"contained",color:"secondary",disableElevation:!0},"Save"),n.a.createElement(we.a,{onClick:a,style:{marginLeft:5},size:"small",variant:"contained",disableElevation:!0},"Cancel")))})),Yt=a(833);var $t=Object(S.a)(yt)((function(e){const t=e.onChangeSection,a=e.currentSection,r=e.classes;return n.a.createElement("div",{className:r.root},n.a.createElement(Yt.a,{"aria-label":"breadcrumb"},n.a.createElement(ft.a,{color:"inherit",href:"/",onClick:e=>((e,a)=>{e.preventDefault(),t(a)})(e,"home"),className:r.bcLink},n.a.createElement(O.a,{className:r.icon}),"Settings"),"home"!==a&&n.a.createElement(Q.a,{color:"textPrimary"},{home:"General",general:"General",networking_and_transport:"Networking and Transport",nat:"NAT",certificates:"Certificates",access_control_lists:"Access Control Lists",rest_service:"Rest Service",data_access:"Data Access",danger_zone:"Danger Zone"}[a])))}));class Vt extends n.a.Component{constructor(e){super(e),this.handleSave=()=>{const e=e=>e&&e.length>0,t=this.state.config,a=this.state;t.spec.dataSource||(t.spec.dataSource={}),(t=>e(t.aclAllow)||e(t.aclDeny))(a)?t.spec.accessControlList={}:delete t.spec.accessControlList,t.metadata||(t.metadata={}),a.localnets&&(t.spec.localnets=a.localnets.toString().split("\n")),e(a.aclDeny)&&(t.spec.accessControlList.deny=a.aclDeny.toString().split("\n")),e(a.aclAllow)&&(t.spec.accessControlList.allow=a.aclAllow.toString().split("\n")),t.metadata.userAgent=a.userAgent,t.spec.bindAddr=a.bindAddr,t.spec.externAddr=a.externAddr,t.spec.registrarIntf=a.registrarIntf,t.spec.recordRoute=a.recordRoute,t.spec.dataSource.provider=a.dsProvider,t.spec.dataSource.parameters=a.dsParameters,t.spec.restService.bindAddr=a.restBindAddr,t.spec.restService.keyStore=a.restKeyStorePath,t.spec.restService.trustStore=a.restTrustStorePath,t.spec.restService.keyStorePassword=a.restKeyStorePassword,t.spec.restService.trustStorePassword=a.restTrustStorePassword,t.spec.restService.unsecured=a.restUnsecured,t.spec.securityContext.keyStore=a.scKeyStorePath,t.spec.securityContext.trustStore=a.scTrustStorePath,t.spec.securityContext.keyStorePassword=a.scKeyStorePassword,t.spec.securityContext.trustStorePassword=a.scTrustStorePassword,t.spec.securityContext.debugging=a.scDebugging,t.spec.securityContext.client.authType=a.scClientAuthType,t.spec.securityContext.keyStoreType=a.scKeyStoreType,a.restPort?t.spec.restService.port=parseInt(a.restPort):delete t.spec.restService.port,a.restMinThreads?t.spec.restService.minThreads=parseInt(a.restMinThreads):delete t.spec.restService.minThreads,a.restMaxThreads?t.spec.restService.maxThreads=parseInt(a.restMaxThreads):delete t.spec.restService.maxThreads,a.restTimeOutMillis?t.spec.restService.timeOutMillis=parseInt(a.restTimeOutMillis):delete t.spec.restService.timeOutMillis;const r=[];a.scTLSv1&&r.push("TLSv1"),a.scTLSv11&&r.push("TLSv1.1"),a.scTLSv12&&r.push("TLSv1.2"),a.scSSLv3&&r.push("SSLv3"),t.spec.securityContext.client.protocols=r;const n=[],s=this.state.transportPorts;s.udp&&n.push({protocol:"udp",port:parseInt(s.udp)}),s.tcp&&n.push({protocol:"tcp",port:parseInt(s.tcp)}),s.tls&&n.push({protocol:"tls",port:parseInt(s.tls)}),s.ws&&n.push({protocol:"ws",port:parseInt(s.ws)}),s.wss&&n.push({protocol:"wss",port:parseInt(s.wss)}),t.spec.transport=n,this.props.apiStore.saveConfig(t),this.setState({currentSection:"home"})},this.handleOnCancel=()=>this.setState({currentSection:"home",updated:!1}),this.isSection=e=>this.state.currentSection===e,this.handleChangeSection=e=>this.setState({currentSection:e,updated:!1}),this.handleChange=e=>{const t=e.currentTarget.id,a=e.target.value,r=this.state.transportPorts;"userAgent"===t&&this.setState({userAgent:a}),"bindAddr"===t&&this.setState({bindAddr:a}),"externAddr"===t&&this.setState({externAddr:a}),"localnets"===t&&this.setState({localnets:a}),"dsProvider"===t&&this.setState({dsProvider:a}),"dsParameters"===t&&this.setState({dsParameters:a}),"registrarIntf"===t&&this.setState({registrarIntf:a}),"aclDeny"===t&&this.setState({aclDeny:a}),"aclAllow"===t&&this.setState({aclAllow:a}),"recordRoute"===t&&this.setState({recordRoute:e.target.checked}),"udpPort"===t&&(r.udp=a,this.setState({transportPorts:r})),"tcpPort"===t&&(r.tcp=a,this.setState({transportPorts:r})),"tlsPort"===t&&(r.tls=a,this.setState({transportPorts:r})),"wsPort"===t&&(r.ws=a,this.setState({transportPorts:r})),"wssPort"===t&&(r.wss=a,this.setState({transportPorts:r})),"restBindAddr"===t&&this.setState({restBindAddr:a}),"restPort"===t&&this.setState({restPort:a}),"restMinThreads"===t&&this.setState({restMinThreads:a}),"restMaxThreads"===t&&this.setState({restMaxThreads:a}),"restTimeOutMillis"===t&&this.setState({restTimeOutMillis:a}),"restKeyStorePath"===t&&this.setState({restKeyStorePath:a}),"restTrustStorePath"===t&&this.setState({restTrustStorePath:a}),"restKeyStorePassword"===t&&this.setState({restKeyStorePassword:a}),"restTrustStorePassword"===t&&this.setState({restTrustStorePassword:a}),"restUnsecured"===t&&this.setState({restUnsecured:e.target.checked}),"scKeyStorePath"===t&&this.setState({scKeyStorePath:a}),"scTrustStorePath"===t&&this.setState({scTrustStorePath:a}),"scKeyStorePassword"===t&&this.setState({scKeyStorePassword:a}),"scTrustStorePassword"===t&&this.setState({scTrustStorePassword:a}),"scClientAuthType"===t&&this.setState({scClientAuthType:a}),"scKeyStoreType"===t&&this.setState({scKeyStoreType:a}),"scDebugging"===t&&this.setState({scDebugging:e.target.checked}),"scTLSv1"===t&&this.setState({scTLSv1:e.target.checked}),"scTLSv11"===t&&this.setState({scTLSv11:e.target.checked}),"scTLSv12"===t&&this.setState({scTLSv12:e.target.checked}),"scSSLv3"===t&&this.setState({scSSLv3:e.target.checked})},this.handleRestartServerNow=()=>{this.props.apiStore.changeStatus("restarting",!0)},this.handleRestartServer=()=>{this.props.apiStore.changeStatus("restarting",!1)},this.handleStopServerNow=()=>{this.props.apiStore.changeStatus("down",!0)},this.handleStopServer=()=>{this.props.apiStore.changeStatus("down",!1)},this.state={updated:!1,config:{},currentSection:"home",userAgent:"",bindAddr:"",externAddr:"",localnets:"",transportPorts:{udp:"",tcp:"",tls:"",ws:"",wss:""},registrarIntf:"Internal",recordRoute:!1,aclDeny:"",aclAllow:"",dsProvider:"files_data_provider",dsParameters:"",restBindAddr:"",restPort:"",restMinThreads:"",restMaxThreads:"",restTimeOutMillis:"",restKeyStorePath:"",restTrustStorePath:"",restKeyStorePassword:"",restTrustStorePassword:"",scKeyStorePath:"",scTrustStorePath:"",scKeyStorePassword:"",scTrustStorePassword:"",scKeyStoreType:"",scDebugging:!1,scClientAuthType:"DisabledAll",scSSLv3:!1,scTLSv1:!1,scTLSv11:!1,scTLSv12:!1,restUnsecured:!1}}componentDidUpdate(e){if(!0===this.state.updated)return;let t=e.apiStore.getConfig(),a="",r="",n="",s="";t=t||{},t.spec=t.spec||{},t.metadata=t.metadata||{},t.spec.transport=t.spec.transport||[],t.spec.securityContext=t.spec.securityContext||{},t.spec.securityContext.client=t.spec.securityContext.client||{},t.spec.securityContext.client.protocols=t.spec.securityContext.client.protocols||[],t.spec.restService=t.spec.restService||{},t.spec.dataSource&&(a=t.spec.dataSource.provider,r=t.spec.dataSource.parameters),t.spec.accessControlList&&t.spec.accessControlList.allow&&(s=t.spec.accessControlList.allow.join("\n")),t.spec.accessControlList&&t.spec.accessControlList.deny&&(n=t.spec.accessControlList.deny.join("\n"));const o={};t.spec.transport.forEach(e=>{o[e.protocol]=e.port});const l=t.spec.securityContext.client.protocols.filter(e=>"TLSv1"===e).length>0,i=t.spec.securityContext.client.protocols.filter(e=>"TLSv1.1"===e).length>0,c=t.spec.securityContext.client.protocols.filter(e=>"TLSv1.2"===e).length>0,d=t.spec.securityContext.client.protocols.filter(e=>"SSLv3"===e).length>0;this.setState({userAgent:t.metadata.userAgent,bindAddr:t.spec.bindAddr,externAddr:t.spec.externAddr,localnets:t.spec.localnets,registrarIntf:t.spec.registrarIntf,recordRoute:t.spec.recordRoute,restBindAddr:t.spec.restService.bindAddr,restPort:t.spec.restService.port,restMinThreads:t.spec.restService.minThreads,restMaxThreads:t.spec.restService.maxThreads,restTimeOutMillis:t.spec.restService.timeOutMillis,restKeyStorePath:t.spec.restService.keyStore,restTrustStorePath:t.spec.restService.trustStore,restKeyStorePassword:t.spec.restService.keyStorePassword,restTrustStorePassword:t.spec.restService.trustStorePassword,restUnsecured:t.spec.restService.unsecured,scKeyStorePath:t.spec.securityContext.keyStore,scTrustStorePath:t.spec.securityContext.trustStore,scKeyStorePassword:t.spec.securityContext.keyStorePassword,scTrustStorePassword:t.spec.securityContext.trustStorePassword,scClientAuthType:t.spec.securityContext.client.authType,scKeyStoreType:t.spec.securityContext.keyStoreType,scDebugging:t.spec.securityContext.debugging,scTLSv1:l,scTLSv11:i,scTLSv12:c,scSSLv3:d,dsParameters:r,dsProvider:a,aclDeny:n,aclAllow:s,config:t,updated:!0,transportPorts:o})}render(e){return n.a.createElement("div",null,n.a.createElement($t,{onChangeSection:this.handleChangeSection,currentSection:this.state.currentSection}),this.isSection("general")&&n.a.createElement(wt,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),this.isSection("nat")&&n.a.createElement(Rt,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),this.isSection("access_control_lists")&&n.a.createElement(qt,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),this.isSection("networking_and_transport")&&n.a.createElement(kt,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),this.isSection("rest_service")&&n.a.createElement(Jt,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),this.isSection("certificates")&&n.a.createElement(Gt,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),this.isSection("data_access")&&n.a.createElement(Ht,{config:this.state,onChange:this.handleChange,onSave:this.handleSave,onCancel:this.handleOnCancel}),"home"===this.state.currentSection&&n.a.createElement(Ct,{onChangeSection:this.handleChangeSection}),this.isSection("danger_zone")&&n.a.createElement(Wt,{onRestartServerNow:this.handleRestartServerNow,onStopServerNow:this.handleStopServerNow,onRestartServer:this.handleRestartServer,onStopServer:this.handleStopServer}))}}var Xt=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(l.c)(Vt))),Zt=a(29),Qt=a.n(Zt),ea=a(44),ta=a(209),aa=a.n(ta),ra=a(208),na=a.n(ra),sa=a(146),oa=a(207),la=a.n(oa);class ia extends n.a.Component{constructor(e){super(e),this.state={sock:null,open:!0,reConnect:!1}}render(){var e=this;return n.a.createElement("div",{style:{height:"calc(100vh - 215px)",width:"100%"}},n.a.createElement("div",{style:{display:"flex",alignItems:"center"}},n.a.createElement(L.a,{color:"primary",size:"small"}),n.a.createElement(Q.a,{color:"primary",variant:"h6",id:"tableTitle"},"Server's Logs")),n.a.createElement("div",{style:{marginTop:25,marginBottom:15}},n.a.createElement(we.a,{style:{marginRight:5},variant:"contained",size:"small",color:"secondary",startIcon:this.state.open?n.a.createElement(na.a,null):n.a.createElement(aa.a,null),onClick:()=>{this.state.open?this.state.sock&&this.state.sock.close():this.setState({reConnect:!this.state.reConnect}),this.setState({open:!this.state.open})}},"Play live"),n.a.createElement(we.a,{onClick:Object(ea.a)(Qt.a.mark((function t(){return Qt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=la.a,t.next=3,e.props.apiStore.getSystemLogs();case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1,"routr.log","text/plain"));case 5:case"end":return t.stop()}}),t)}))),variant:"outlined",size:"small"},"Download Logs")),n.a.createElement(sa.ScrollFollow,{key:this.state.reConnect,startFollowing:!0,render:({follow:e,onScroll:t})=>n.a.createElement(sa.LazyLog,{enableSearch:!0,url:this.props.apiStore.getSystemLogsURL(),websocket:!0,follow:e,onScroll:t,websocketOptions:{onOpen:(e,t)=>{this.setState({sock:t}),this.state.sock.send(JSON.stringify({message:"Open channel!"}))},onClose:()=>{this.setState({open:!1})},formatMessage:e=>e}})}))}}var ca=Object(l.b)("apiStore")(Object(l.c)(ia)),da=a(836);class ua extends n.a.Component{constructor(...e){super(...e),this.handleClose=()=>this.props.appStore.setNotificationOpen()}render(){return n.a.createElement("div",null,n.a.createElement(da.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:this.props.appStore.isNotificationOpen(),autoHideDuration:15e3,onClose:this.handleClose,ContentProps:{"aria-describedby":"message-id"},message:n.a.createElement("span",{id:"message-id"},this.props.appStore.notificationMsg),action:[n.a.createElement(u.a,{key:"close","aria-label":"Close",color:"inherit",onClick:this.handleClose},n.a.createElement(be.a,null))]}))}}var ma=Object(l.b)("appStore")(Object(l.c)(ua)),pa=a(210),ha=a.n(pa);class ga extends n.a.Component{constructor(...e){super(...e),this.createSortHandler=e=>t=>{this.props.onRequestSort(t,e)}}render(){const e=this.props,t=e.order,a=e.orderBy,r=e.columnData;return n.a.createElement($.a,null,n.a.createElement(X.a,null,r.map(e=>n.a.createElement(Y.a,{key:e.id,sortDirection:a===e.id&&t},n.a.createElement(ae.a,{title:"Sort",placement:e.numeric?"bottom-end":"bottom-start",enterDelay:300},n.a.createElement(Z.a,{active:a===e.id,direction:t,onClick:this.createSortHandler(e.id)},e.label))),this)))}}let Sa=e=>{const t=e.classes,a=e.name,r=e.handleRefresh;return n.a.createElement(d.a,null,n.a.createElement("div",{className:t.title},n.a.createElement(Q.a,{variant:"h6",id:"tableTitle"},Ue(a))),n.a.createElement("div",{className:t.spacer}),n.a.createElement("div",{className:t.actions},n.a.createElement(ae.a,{title:"Refresh"},n.a.createElement(u.a,{"aria-label":"Refresh",onClick:r},n.a.createElement(ha.a,null)))))};Sa=Object(S.a)(e=>({root:{paddingRight:e.spacing(1)},highlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(le.lighten)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},spacer:{flex:"1 1 100%"},actions:{color:e.palette.text.secondary},title:{flex:"0 0 auto"}}))(Sa);class ba extends n.a.Component{constructor(e){super(e),this.handleRequestSort=(e,t)=>{const a=t;let r="desc";this.state.orderBy===t&&"desc"===this.state.order&&(r="asc");const n="desc"===r?this.state.data.sort((e,t)=>t[a]<e[a]?-1:1):this.state.data.sort((e,t)=>e[a]<t[a]?-1:1);this.setState({data:n,order:r,orderBy:a})},this.handleChangePage=(e,t)=>{this.setState({page:t})},this.handleChangeRowsPerPage=e=>{this.setState({rowsPerPage:e.target.value})},this.state={order:"asc",orderBy:"calories",data:e.data,page:0,rowsPerPage:5}}render(){const e=this.props,t=e.classes,a=e.columnData,r=e.data,s=e.name,o=e.apiStore,l=this.state,i=l.order,c=l.orderBy,d=l.rowsPerPage,u=l.page,m=d-Math.min(d,r.length-u*d);return n.a.createElement(ee.a,{className:t.root},n.a.createElement(Sa,{name:s,handleRefresh:e=>o.loadResources(this.props.appStore.getCurrentSection())}),n.a.createElement("div",{className:t.tableWrapper},n.a.createElement(G.a,{className:t.table,"aria-labelledby":"tableTitle"},n.a.createElement(ga,{columnData:a,order:i,orderBy:c,onRequestSort:this.handleRequestSort}),n.a.createElement(q.a,null,r.slice(u*d,u*d+d).map(e=>n.a.createElement(X.a,{hover:!0,tabIndex:-1,key:e.c1},n.a.createElement(Y.a,{component:"th",scope:"row"},e.c1),n.a.createElement(Y.a,null,e.c2),e.c3&&n.a.createElement(Y.a,null,e.c3),e.c4&&n.a.createElement(Y.a,null,e.c4))),m>0&&n.a.createElement(X.a,{style:{height:49*m}},n.a.createElement(Y.a,{colSpan:6}))))),n.a.createElement(V.a,{component:"div",count:r.length,rowsPerPage:d,page:u,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:this.handleChangePage,onChangeRowsPerPage:this.handleChangeRowsPerPage}))}}var Ea=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)(e=>({root:{width:"100%",marginTop:e.spacing(1)},table:{minWidth:1020},tableWrapper:{overflowX:"auto"}}))(Object(l.c)(ba))));const va=Object(S.a)(e=>({root:{borderBottom:"1px solid ".concat(e.palette.divider),margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}))(e=>{const t=e.children,a=e.classes,r=e.onClose;return n.a.createElement(ke.a,{disableTypography:!0,className:a.root},n.a.createElement(Q.a,{variant:"h6"},t),r?n.a.createElement(u.a,{"aria-label":"Close",className:a.closeButton,onClick:r},n.a.createElement(be.a,null)):null)}),fa=Object(S.a)(e=>({root:{margin:0,padding:0}}))(Oe.a);class ya extends n.a.Component{render(){return n.a.createElement("div",null,n.a.createElement(ge.a,{"aria-labelledby":"customized-dialog-title",onClose:this.props.appStore.setAboutDialogOpen,open:this.props.appStore.isAboutDialogOpen()},n.a.createElement(va,{id:"customized-dialog-title",onClose:this.props.appStore.setAboutDialogOpen},"About"),n.a.createElement(fa,null,n.a.createElement(rt.a,null,n.a.createElement(Q.a,{color:"textSecondary"},"v1.0"),n.a.createElement(Q.a,{component:"p"},'Routr is a lightweight sip proxy, location server, and registrar that provides a reliable and scalable SIP infrastructure for telephony carriers, communication service providers, and integrators. This is the version "1.0" of Routr console. ',n.a.createElement("br",null),'"Next-generation SIP Server"')))))}}var Ca=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)({appBar:{position:"relative"},flex:{flex:1}})(Object(l.c)(ya))));class Pa extends n.a.Component{render(){const e=this.props,t=e.classes,a=e.appStore,r=e.apiStore,s=gt(a.getCurrentSection()),o=r.getResources();return n.a.createElement("div",{className:t.root},n.a.createElement(c.a,{position:"absolute",className:t.appBar},n.a.createElement(E,null)),n.a.createElement(i.a,{variant:"permanent",classes:{paper:t.drawerPaper}},n.a.createElement("div",{className:t.toolbar}),n.a.createElement(H,null)),n.a.createElement("main",{className:t.content,style:{backgroundColor:"settings"===a.getCurrentSection()?"#fff":""}},n.a.createElement("div",{className:t.toolbar}),a.isResourceSection()&&n.a.createElement(vt,null),a.isLocOrRegSection()&&n.a.createElement(Ea,{name:Ue(a.getCurrentSection()),columnData:s,data:o}),a.isLogsSection()&&n.a.createElement(ca,null),a.isSettingsSection()&&n.a.createElement(Xt,null),n.a.createElement(ma,null),n.a.createElement(Ca,null)))}}var wa=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(S.a)(e=>({root:{flexGrow:1,zIndex:1,overflow:"hidden",position:"relative",display:"flex",height:"100vh"},appBar:{zIndex:e.zIndex.drawer+1},drawerPaper:{position:"relative",width:240},content:{overflow:"scroll",flexGrow:1,backgroundColor:e.palette.background.default,padding:e.spacing(3),minWidth:0},toolbar:e.mixins.toolbar}))(Object(l.c)(Pa))));class ka extends r.Component{render(){return n.a.createElement(ge.a,{fullScreen:!0,style:{backgroundColor:"#33383d"},open:!0,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},n.a.createElement(ke.a,{style:{backgroundColor:"#33383d",color:"#fff"},id:"alert-dialog-title"},n.a.createElement("img",{src:"/images/logo.png",className:"App-logo",alt:"logo"})),n.a.createElement(Oe.a,{style:{backgroundColor:"#fff"}},n.a.createElement(Q.a,{id:"tableTitle",style:{color:"#33383d"}},"Console cannot connect to running routr engine. Re-trying ...")))}}var Oa=ka;class xa extends r.Component{constructor(...e){super(...e),this.state={token:"",badToken:!1}}render(){var e=this;const t=function(){var t=Object(ea.a)(Qt.a.mark((function t(a){return Qt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),e.props.apiStore.setToken(e.state.token),t.next=4,e.props.apiStore.loadConfig();case 4:e.props.apiStore.isAuthorized()||e.setState({token:"",badToken:!0});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return n.a.createElement(ge.a,{open:!0,"aria-labelledby":"form-dialog-title"},n.a.createElement("form",{onSubmit:t},n.a.createElement(ke.a,{style:{backgroundColor:"#33383d"},id:"form-dialog-title"},n.a.createElement("img",{src:"/images/logo.png",className:"App-logo",alt:"logo"})),n.a.createElement(Oe.a,null,n.a.createElement(Mt.a,null,"To access the web console, please enter the access token. Refer to",n.a.createElement(we.a,{href:"https://routr.io/docs/api/token/",color:"primary"},"authentication")," to obtain a token."),this.state.badToken&&n.a.createElement("p",{style:{color:"#33383d"}},"Bad token!"),n.a.createElement(Pt.a,{onChange:e=>{const t=e.currentTarget.id,a=e.target.value;"token"===t&&this.setState({token:a,badToken:!1})},value:this.state.token,autoFocus:!0,margin:"dense",id:"token",label:"Enter Token",type:"text",fullWidth:!0})),n.a.createElement(xe.a,null,n.a.createElement(we.a,{style:{marginRight:15},type:"submit",onClick:t,color:"primary"},"Sign in"))))}}var Ta=Object(l.b)("apiStore")(Object(l.c)(xa)),Na=a(211),Ra=a(147);const Aa=Object(Ft.a)({typography:{useNextVariants:!0},palette:{primary:{light:"#757ce8",main:"#33383d",dark:"#002884",contrastText:"#fff"},secondary:{main:"#3F51B5"}}});class La extends r.Component{constructor(e){super(e),this.handleCloseUpdateSnack=()=>{this.setState({snackOpen:!1})},this.state={url:"https://google.com",snackOpen:!0}}componentDidMount(){Me("token")&&this.props.apiStore.setToken(Me("token")),Me("apiUrl")&&this.props.apiStore.setApiURL(Me("apiUrl")),this.setState({url:this.props.apiStore.getPingEndpoint()})}render(){const e={enabled:!0,url:this.state.url,interval:2e3,timeout:2e3};return n.a.createElement("div",{className:"App"},n.a.createElement(Kt.a,{theme:Aa},n.a.createElement(Ra.Online,{polling:e},this.props.apiStore.isReady()&&this.props.apiStore.isAuthorized()&&n.a.createElement(wa,null),this.props.apiStore.isReady()&&!this.props.apiStore.isAuthorized()&&n.a.createElement("div",{style:{backgroundColor:"#fafafa",height:"100vh",width:"100vw"}},n.a.createElement(Ta,null))),n.a.createElement(Ra.Offline,{polling:e},n.a.createElement("div",{style:{width:"100vw",height:"100vh",backgroundColor:"#33383d"}},n.a.createElement(Oa,null))),n.a.createElement(Na.a,null,({isLatestVersion:e,emptyCacheStorage:t})=>n.a.createElement("div",null,!e&&n.a.createElement(da.a,{open:this.state.snackOpen,anchorOrigin:{vertical:"bottom",horizontal:"center"},autoHideDuration:15e3,onClose:this.handleCloseUpdateSnack,message:"A new version of the web console is available",action:[n.a.createElement(we.a,{key:"update","aria-label":"Update console",size:"small",variant:"contained",onClick:e=>{e.preventDefault(),t()}},"Update now")]})))))}}var ja=Object(l.b)("apiStore")(Object(l.b)("appStore")(Object(l.c)(La)));const za=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Da(e){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const t=e.installing;t.onstatechange=()=>{"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(e=>{console.error("Error during service worker registration:",e)})}var Ba=a(9);class Ia{constructor(){this.currentResource={},this.resourceEditorOpen=!1,this.aboutDialogOpen=!1,this.fileUploaderOpen=!1,this.notificationOpen=!1,this.notificationMsg="",this.currentSection="domains",this.notify=(e,t)=>{this.notificationMsg=e,this.setNotificationOpen()},this.setNotificationOpen=()=>this.notificationOpen=!this.notificationOpen,this.setCurrentResource=e=>this.currentResource=e,this.setResourceEditorOpen=()=>this.resourceEditorOpen=!this.resourceEditorOpen,this.setAboutDialogOpen=()=>this.aboutDialogOpen=!this.aboutDialogOpen,this.setFileUploaderOpen=()=>this.fileUploaderOpen=!this.fileUploaderOpen,this.setCurrentSection=e=>this.currentSection=e,this.getCurrentSection=()=>this.currentSection,this.getCurrentResource=()=>this.currentResource,this.isResourceSection=()=>"domains"===this.currentSection||"agents"===this.currentSection||"peers"===this.currentSection||"gateways"===this.currentSection||"numbers"===this.currentSection,this.isLocOrRegSection=()=>"location"===this.currentSection||"registration"===this.currentSection,this.isSettingsSection=()=>"settings"===this.currentSection,this.isLogsSection=()=>"logs"===this.currentSection,this.isAboutDialogOpen=()=>this.aboutDialogOpen,this.isResourceEditorOpen=()=>this.resourceEditorOpen,this.isFileUploaderOpen=()=>this.fileUploaderOpen,this.isNotificationOpen=()=>this.notificationOpen}}Object(Ba.i)(Ia,{currentResource:Ba.n,currentSection:Ba.n,resourceEditorOpen:Ba.n,aboutDialogOpen:Ba.n,fileUploaderOpen:Ba.n,notificationMsg:Ba.n,notificationOpen:Ba.n});const Ua=new Ia;class Ma{constructor(){var e=this;this.resources=[],this.endpointBase="/api/v1beta1",this.ready=!1,this.authorized=!1,this.config={spec:{restService:{},securityContext:{}}},this.token="",this.update=e=>{if(this.doesNotSupportWOOps())return void Ua.notify("Operation not supported by data source provider.");let t;try{t=JSON.parse(e)}catch(n){return void Ua.notify("Malformed document.")}const a=Ua.getCurrentSection(),r=Fe(this.endpointBase,a+"/"+t.metadata.ref,"",this.token);fetch(r,{method:"PUT",body:e}).then(e=>e.json()).then(e=>{200===e.status?Ua.notify("Updated resource."):422===e.status&&e.data?Ua.notify(e.message+": "+e.data):Ua.notify(e.message),this.loadResources(Ua.getCurrentSection())})},this.delete=function(){var t=Object(ea.a)(Qt.a.mark((function t(a,r){var n,s,o,l,i;return Qt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.doesNotSupportWOOps()){t.next=3;break}return Ua.notify("Operation not supported by data source provider."),t.abrupt("return");case 3:n=t=>Fe(e.endpointBase,a+"/"+t,"",e.token),s=[],o=0;case 6:if(!(o<r.length)){t.next=22;break}return t.next=9,fetch(n(r[o]),{method:"DELETE"});case 9:return l=t.sent,t.next=12,l.json();case 12:if(405!==(i=t.sent).status&&409!==i.status){t.next=18;break}return Ua.notify(i.message),t.abrupt("return");case 18:200!==i.status&&s.push(i.message);case 19:o++,t.next=6;break;case 22:e.loadResources(Ua.getCurrentSection()),s.length>0?Ua.notify("An error occurred while deleting the resources."):Ua.notify("".concat(r.length," ").concat(Ua.getCurrentSection()," removed."));case 24:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),this.loadResources=function(){var t=Object(ea.a)(Qt.a.mark((function t(a){var r,n,s,o,l;return Qt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="registration"===a?"registry":a,n=Fe(e.endpointBase,r,"*",e.token),t.next=4,fetch(n);case 4:return s=t.sent,t.prev=5,t.next=8,s.json();case 8:200===(o=t.sent).status?(l=[],o&&o.data&&o.data.forEach(e=>{l.push(St(e,a))}),e.resources=l):Ua.notify(o.message),t.next=14;break;case 12:t.prev=12,t.t0=t.catch(5);case 14:case"end":return t.stop()}}),t,null,[[5,12]])})));return function(e){return t.apply(this,arguments)}}(),this.getResources=()=>this.resources,this.setApiURL=e=>this.apiURL=e,this.getApiURL=()=>this.apiURL,this.getToken=()=>this.token,this.setToken=e=>this.token=e,this.saveConfig=e=>{if(this.doesNotSupportWOOps())return void Ua.notify("Operation not supported by data source provider.");const t=Fe(this.endpointBase,"system/config","",this.token);fetch(t,{method:"PUT",body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{if(200===e.status)Ua.notify("Configuration changes will take effect on the next restart");else{let t=e.message;e.data&&(t+=": "+e.data),Ua.notify(t)}})},this.changeStatus=(e,t)=>{const a="system/status/".concat(e),r=Fe(this.endpointBase,a,"now=".concat(t),this.token);fetch(r,{method:"POST"}).then(e=>e.json()).then(e=>{if(200===e.status)Ua.notify("Restarting.");else{let t=e.message;e.data&&(t+=": "+e.data),Ua.notify(t)}})},this.loadConfig=Object(ea.a)(Qt.a.mark((function t(){var a,r,n;return Qt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"system/config",a=Fe(e.endpointBase,"system/config","*",e.token),t.next=4,fetch(a);case 4:return r=t.sent,t.next=7,r.json();case 7:n=t.sent,e.ready=!0,200===n.status?(e.config=n.data,e.authorized=!0):401===n.status?e.authorized=!1:Ua.notify(n.message);case 10:case"end":return t.stop()}}),t)}))),this.getConfig=()=>this.config,this.doesNotSupportWOOps=()=>"files_data_provider"===this.config.spec.dataSource.provider,this.getSystemLogs=Object(ea.a)(Qt.a.mark((function t(){var a,r,n;return Qt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"system/logs",a=Fe(e.endpointBase,"system/logs","",e.token),t.next=4,fetch(a,{method:"GET"});case 4:return r=t.sent,t.next=7,r.json();case 7:if(200!==(n=t.sent).status){t.next=12;break}return t.abrupt("return",n.data);case 12:Ua.notify(n.message);case 13:case"end":return t.stop()}}),t)}))),this.getSystemLogsURL=()=>{const e=(this.getApiURL()?this.getApiURL():window.location.origin).replace("http","ws");return"".concat(e).concat(Fe(this.endpointBase,"system/logs-ws","",this.token))},this.getPingEndpoint=()=>Fe(this.endpointBase,"system/status","",this.token),this.isReady=()=>this.ready,this.isAuthorized=()=>this.authorized,Object(Ba.s)(()=>""!==this.token||!0,Object(ea.a)(Qt.a.mark((function t(){return Qt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loadConfig(),t.next=3,setTimeout(()=>{},1500);case 3:"settings"!==Ua.getCurrentSection()&&e.loadResources(Ua.getCurrentSection());case 4:case"end":return t.stop()}}),t)}))))}}Object(Ba.i)(Ma,{resources:Ba.n,token:Ba.n,config:Ba.n,ready:Ba.n,authorized:Ba.n});const Fa=new Ma,Ka={appStore:Ua,apiStore:Fa};o.a.render(n.a.createElement(l.a,Ka,n.a.createElement(ja,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",()=>{const e="".concat("","/service-worker.js");za?(!function(e){fetch(e).then(t=>{404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):Da(e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):Da(e)})}}()}},[[237,1,2]]]);
//# sourceMappingURL=main.f26b0da6.chunk.js.map